# Story 36.4: Brownfield Story Protocol

<!-- Source: docs/prd/epic-4-story-driven-development-loop.md -->
<!-- Context: Story-Driven Development Loop - Brownfield constraints for safer incremental change -->

## Status

**Draft**

**Last Updated:** 2025-12-18

## Story

**As a** TappsCodingAgents autonomous agent working in an existing codebase,  
**I want** an automated brownfield-friendly story protocol,  
**so that** each change includes automated regression detection, integration checkpoints, and rollback guidance.

## Acceptance Criteria

1. Automated brownfield-specific requirements are defined for stories (automated regression detection, integration checkpoints, and "what must not break" notes).
2. Stories include automated verification expectations for existing behaviors (what to re-check after changes).
3. Stories include automated rollback triggers (how to revert safely if verification fails).
4. The protocol aligns with BMAD's brownfield guidance and is usable for both small fixes and multi-story enhancements, all without human intervention.

## Tasks / Subtasks

- [ ] Task 1: Define brownfield-required sections and prompts (AC: 1, 2)
  - [ ] Define “existing behavior” verification checklist expectations
  - [ ] Define integration checkpoint guidance
- [ ] Task 2: Define rollback guidance expectations (AC: 3)
  - [ ] Define what “rollback plan” must contain (minimal and actionable)
- [ ] Task 3: Align protocol to BMAD brownfield guidance (AC: 4)
  - [ ] Reference `.bmad-core/working-in-the-brownfield.md`
  - [ ] Ensure protocol scales down for small changes

## Dev Notes

### Existing System Context

- BMAD’s brownfield operating model is documented in `.bmad-core/working-in-the-brownfield.md`.
- This repo already contains multiple “brownfield enhancement” stories; this story standardizes the brownfield-specific constraints rather than relying on ad-hoc conventions.

## Testing

- Documentation-only change; no automated tests required.
- Validation approach: apply the protocol to one existing brownfield story and check that regression and rollback guidance are explicit and minimal.

## Change Log

| Date       | Version | Description                 | Author      |
| ---------- | ------- | --------------------------- | ----------- |
| 2025-12-18 | 0.1     | Initial draft for Story 36.4 | bmad-master |

## Dev Agent Record

### Agent Model Used

_TBD_

### Debug Log References

_TBD_

### Completion Notes List

_TBD_

### File List

_TBD_

## QA Results

_To be populated by QA agent_


