# Story 23.4: Normalize reporting and artifacts

<!-- Source: implementation/cursor/EPIC_23_CI_Gating_And_Workflow_Consolidation.md -->
<!-- Context: Always-on JUnit + coverage artifacts, consistent summaries, and safe redaction for failure diagnostics -->

```yaml
story_id: 23.4
title: Normalize reporting and artifacts
description: Standardize CI artifacts and reporting so failures are diagnosable without reruns, including always-uploaded JUnit/coverage and consistent summaries, with redaction where applicable.
epic: EPIC_23_CI_Gating_And_Workflow_Consolidation
domain: CI/CD Observability
priority: medium
complexity: 3
status: draft
created_at: 2025-12-16
created_by: planner
```

## Acceptance Criteria

- [ ] JUnit XML artifacts are produced and uploaded for relevant test jobs (unit/e2e) even on failure (`if: always()`).
- [ ] Coverage artifacts (and/or uploaded coverage reports) are produced and uploaded for relevant jobs even on failure (`if: always()`).
- [ ] Failure artifacts are captured in a consistent location and are redacted where applicable (reuse existing redaction utilities if present).
- [ ] Successful runs produce expected artifacts and summaries (Definition of Done IV2).
- [ ] Fork PRs run without secrets; missing credentials for real-service suites must skip cleanly (Epic compatibility requirement).

## Tasks

1. Standardize test runner flags for reporting outputs
   - Ensure pytest is configured to emit JUnit XML and coverage outputs in stable paths.

2. Ensure artifacts upload on failure without masking job conclusion
   - Add dedicated upload steps guarded by `if: always()`.

3. Add consistent job summaries pointing to artifacts
   - Provide a “what failed” and “where to look” summary, including paths and reproduction steps.

4. Implement/redact sensitive failure artifacts
   - Identify any logs that may contain tokens/credentials and apply redaction before upload.

5. Validate outcomes in CI
   - Verify artifacts are present on both failing and passing runs.

## Technical Notes

- This story complements 23.1 by ensuring that “strict failures” still yield high-quality diagnostics.
- If redaction utilities are not yet present, define a minimal redaction step (denylist patterns for known token formats) with clear documentation.

## Dependencies

- Related stories: ["23.1", "23.2"]
- Blocks: []
- Blocked by: ["23.1"]


