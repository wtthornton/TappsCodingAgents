# Story 5.5: Standard Workflow Templates + Progress Monitoring

<!-- Source: implementation/cursor/EPIC_05_Workflow_Engine.md -->
<!-- Context: Ship usable presets (feature/full-sdlc/quick-fix) with monitoring -->

## Status

Draft

## Story

**As a** user of TappsCodingAgents,
**I want** a set of standard, well-tested YAML workflow templates with clear progress reporting,
**so that** I can run common development workflows reliably and understand what the system is doing.

## Acceptance Criteria

1. Provide at least 3 standard, documented YAML workflows (templates/presets), including:
   - feature implementation workflow
   - full SDLC workflow
   - quick-fix workflow
2. Standard workflows are validated and executable end-to-end using the workflow engine:
   - Parse + validation passes via `WorkflowParser`.
   - Dependency validation/resolution (once implemented) passes.
   - Workflows run via `WorkflowExecutor` in headless mode and via the Cursor execution path when in Cursor mode.
3. Progress monitoring exists and is observable during execution:
   - Workflow status exposes current step, completed/skipped counts, and key events.
   - Execution emits structured events suitable for CLI/UI consumption (and/or the append-only event log).
4. Existing workflow definitions remain functional (no breaking changes).
5. Tests ensure shipped workflows remain parseable and basic execution plumbing remains healthy.

## Tasks / Subtasks

- [ ] Task 1: Inventory existing workflows and map to required “standard” set (AC: 1, 4)
  - [ ] Review existing YAML under `workflows/` and `workflows/presets/`
  - [ ] Identify gaps vs feature-implementation/full-sdlc/quick-fix naming and content

- [ ] Task 2: Create/adjust standard workflow templates (AC: 1–2)
  - [ ] Add or update YAML files under `workflows/presets/` (or top-level `workflows/`) to match the standard set
  - [ ] Ensure step ids, routing, artifacts (`creates`/`requires`) are consistent with executor behavior

- [ ] Task 3: Add progress monitoring hooks and UX (AC: 3)
  - [ ] Ensure `WorkflowExecutor.get_status()` includes enough detail for progress reporting
  - [ ] Emit step lifecycle events through the logger and/or event log

- [ ] Task 4: Documentation (AC: 1, 3)
  - [ ] Document how to run each standard workflow and how to customize steps

- [ ] Task 5: Tests (AC: 4–5)
  - [ ] Keep regression parse tests that parse all YAML workflows
  - [ ] Add a lightweight execution smoke test (mock agents where needed)

## Dev Notes

### Existing System Context

- The repository already ships workflows:
  - Top-level: `workflows/*.yaml` (e.g., `multi-agent-refactor.yaml`, `multi-agent-review-and-test.yaml`)
  - Presets: `workflows/presets/*.yaml` (e.g., `full-sdlc.yaml`, `quick-fix.yaml`, `maintenance.yaml`, `quality.yaml`, `rapid-dev.yaml`)
- Workflow selection/recommendation exists:
  - `tapps_agents/workflow/recommender.py` and `tapps_agents/workflow/detector.py` support recommending workflows.
- Progress/logging scaffolding exists:
  - `tapps_agents/workflow/logging_helper.py::WorkflowLogger`
  - `WorkflowExecutor.get_status()` returns a status dict.
- Tests already enforce “shipped workflows parse”:
  - `tests/unit/test_workflow_parser.py::test_repo_workflows_parse`

### Integration Approach

- Prefer evolving the existing preset YAML files to satisfy the “standard workflows” requirement.
- Keep executor mappings aligned with actual agent command capabilities (see `WorkflowExecutor._execute_step_for_parallel` and `_execute_step`).
- Keep compatibility: existing YAML continues to parse and run.

### Risk Assessment

- **Risk**: Preset workflows drift from executor mappings (agent/action strings) and become non-functional.
- **Mitigation**: Add a lightweight smoke test that loads each preset and validates critical fields and/or runs a stubbed execution.

### Rollback Plan

- Revert preset YAML changes while keeping parser validation improvements and tests.

### Testing

- Use `pytest`.
- Relevant tests:
  - `tests/unit/test_workflow_parser.py` (parse regression)
  - `tests/unit/test_workflow_executor.py` (executor API behavior)
  - `tests/integration/test_e2e_workflow_real.py` (opt-in real LLM workflows)

## Change Log

| Date       | Version | Description                       | Author      |
| ---------- | ------- | --------------------------------- | ----------- |
| 2025-12-14 | 0.1     | Initial draft for Epic 5.5        | bmad-master |

## Dev Agent Record

### Agent Model Used

_TBD_

### Debug Log References

_TBD_

### Completion Notes List

- _TBD_

### File List

- _TBD_

## QA Results

_TBD_
