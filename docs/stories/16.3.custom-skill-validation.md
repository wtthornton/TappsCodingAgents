# Story 16.3: Custom Skill Validation

<!-- Source: implementation/EPIC_16_Custom_Skills_Support.md -->

## Status

**âœ… Completed**

**Last Updated:** 2025-01-27

## Story

**As a** framework user,
**I want** custom Skills to be validated for format and capability correctness,
**so that** invalid Skills are caught early and don't break the framework.

## Acceptance Criteria

1. Skill validation system validates Skill format
2. Format validation checks YAML frontmatter and markdown structure
3. Capability validation ensures Skills work correctly
4. Validation error reporting provides clear error messages
5. Invalid Skills are rejected with helpful error messages

## Tasks / Subtasks

- [x] Task 1: Create Skill validation system (AC: 1)
  - [x] Create `SkillValidator` class
  - [x] Implement validation entry point
  - [x] Add validation result reporting
  - [x] Integrate with Skill loader

- [x] Task 2: Implement format validation (AC: 2)
  - [x] Validate YAML frontmatter structure
  - [x] Check required fields (name, description, allowed-tools, model_profile)
  - [x] Validate markdown structure and sections
  - [x] Check file encoding and format

- [x] Task 3: Implement capability validation (AC: 3)
  - [x] Validate tool names are valid
  - [x] Check model_profile references
  - [x] Validate command syntax
  - [x] Verify Skill structure completeness

- [x] Task 4: Create error reporting (AC: 4, 5)
  - [x] Generate clear error messages
  - [x] Report validation errors with file location
  - [x] Provide suggestions for fixing errors
  - [x] Log validation results

## Dev Notes

### Existing System Context

- Skills use YAML frontmatter + markdown format
- Built-in Skills follow specific structure
- Validation patterns exist in framework
- Error reporting in CLI commands

### Integration Approach

- Create validation module `tapps_agents/core/skill_validator.py`
- Use YAML parser for frontmatter validation
- Validate against Skill schema
- Integrate with Skill loader (validate before loading)
- Add CLI command for manual validation

### Technical Details

- **Validator Module**: `tapps_agents/core/skill_validator.py` (new)
- **Validation Schema**: Define required/optional fields
- **YAML Parser**: Use `yaml` library for frontmatter
- **Markdown Parser**: Validate structure and sections
- **Error Format**: Structured error messages with location

### Risk Assessment

- **Primary risk**: Validation may be too strict
  - **Mitigation**: Allow optional fields, provide clear error messages
- **Primary risk**: Validation may miss issues
  - **Mitigation**: Comprehensive checks, test with various Skills

### Rollback Plan

- Disable validation
- Allow all Skills to load
- No impact on existing Skills

### Testing

- Test validation with valid Skills
- Test validation with invalid Skills
- Test error message clarity
- Test validation performance
- Test integration with loader

## Change Log

| Date       | Version | Description                     | Author      |
| ---------- | ------- | ------------------------------- | ----------- |
| 2025-01-27 | 0.1     | Initial draft for Epic 16.3     | James       |

## Dev Agent Record

### Completion Notes

- Created `SkillValidator` class in `tapps_agents/core/skill_validator.py` with comprehensive validation:
  - Format validation: YAML frontmatter structure, required fields, markdown sections, file encoding
  - Capability validation: Tool name validation, model_profile checks, name format validation
  - Error reporting: Clear error messages with suggestions, severity levels (ERROR, WARNING, INFO)
- Integrated validation with `CustomSkillLoader` to validate Skills before loading
- Added CLI command `skill validate` with options for specific skill validation, warning filtering, and JSON/text output
- All acceptance criteria met

### File List

- `tapps_agents/core/skill_validator.py` (new)
- `tapps_agents/core/skill_loader.py` (modified - added validation integration)
- `tapps_agents/cli/parsers/top_level.py` (modified - added skill validate command)
- `tapps_agents/cli/commands/top_level.py` (modified - added skill validation handler)
- `tapps_agents/cli/main.py` (modified - added skill command routing)

### Change Log

_TBD_

## QA Results

_TBD_

