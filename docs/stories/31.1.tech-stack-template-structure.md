# Story 31.1: Tech Stack Template Structure

<!-- Source: implementation/EPIC_03_Dynamic_Tech_Stack_Templates.md -->
<!-- Context: Brownfield enhancement - Create tech stack template directory and format -->

## Status

**Ready for Review**

## Story

**As a** framework user,
**I want** tech stack-specific configuration templates,
**so that** my project gets optimal default configuration automatically based on detected technology stack.

## Acceptance Criteria

1. `templates/tech_stacks/` directory is created in project structure
2. Template file format (YAML) is defined with sections: `agent_config`, `context7_prepop`, `expert_priorities`, `test_frameworks`
3. FastAPI template is created with appropriate configuration values
4. Next.js template is created with appropriate configuration values
5. Template format is documented with structure explanation
6. Templates are valid YAML and follow defined structure

## Tasks / Subtasks

- [x] Task 1: Create directory structure (AC: 1)
  - [x] Create `templates/tech_stacks/` directory
  - [x] Add to project structure
  - [x] Document directory purpose

- [x] Task 2: Define template format (AC: 2)
  - [x] Define YAML structure with required sections
  - [x] Define `agent_config` section (agent thresholds, settings)
  - [x] Define `context7_prepop` section (libraries to pre-cache)
  - [x] Define `expert_priorities` section (expert priority mappings)
  - [x] Define `test_frameworks` section (test framework defaults)

- [x] Task 3: Create FastAPI template (AC: 3, 6)
  - [x] Create `fastapi.yaml` template
  - [x] Configure agent thresholds for async code
  - [x] Add Context7 pre-population for FastAPI docs
  - [x] Set expert priorities (API Design, Observability)
  - [x] Configure pytest-asyncio defaults

- [x] Task 4: Create Next.js template (AC: 4, 6)
  - [x] Create `nextjs.yaml` template
  - [x] Configure agent thresholds for React/Next.js
  - [x] Add Context7 pre-population for Next.js docs
  - [x] Set expert priorities (Frontend, UX)
  - [x] Configure testing defaults

- [x] Task 5: Document format (AC: 5)
  - [x] Document template structure
  - [x] Explain each section
  - [x] Provide template creation guide

## Dev Notes

### Existing System Context

- Template system exists in `templates/` directory
- YAML configuration files are used throughout
- Tech stack detection identifies frameworks
- Context7 pre-population exists in init_project()

### Integration Approach

- Create templates directory following existing template patterns
- Use YAML format consistent with other configs
- Reference Epic 2 expert priorities in templates
- Follow existing configuration structure

### Risk Assessment

- **Primary risk**: Template format may be too rigid
  - **Mitigation**: Extensible format, optional sections, user can override
- **Primary risk**: Templates may become outdated
  - **Mitigation**: Version templates, update process, documentation

### Rollback Plan

- Remove templates directory
- Templates are optional, can be created manually
- No breaking changes

### Testing

- Validate template YAML syntax
- Test template structure matches format
- Review templates for correctness
- Test template loading

## Change Log

| Date       | Version | Description                     | Author      |
| ---------- | ------- | ------------------------------- | ----------- |
| 2025-01-XX | 0.1     | Initial draft for Epic 31.1     | bmad-master |

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5

### Debug Log References

N/A - No errors encountered

### Completion Notes List

- Created `templates/tech_stacks/` directory structure
- Defined YAML template format with 4 main sections: `agent_config`, `context7_prepop`, `expert_priorities`, `test_frameworks`
- Created FastAPI template with async-focused configuration, Context7 pre-pop for FastAPI ecosystem, expert priorities aligned with API development
- Created Next.js template with frontend-focused configuration, Context7 pre-pop for React/Next.js ecosystem, expert priorities for fullstack development
- Created comprehensive README.md documenting template format, sections, creation process, and best practices

### File List

- `templates/tech_stacks/` (directory)
- `templates/tech_stacks/fastapi.yaml` (new)
- `templates/tech_stacks/nextjs.yaml` (new)
- `templates/tech_stacks/README.md` (new)

## QA Results

_TBD_

