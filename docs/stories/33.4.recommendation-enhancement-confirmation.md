# Story 33.4: Recommendation Enhancement & Confirmation

<!-- Source: implementation/EPIC_05_Workflow_Recommendation_Engine_Enhancement.md -->

## Status

**Ready for Review**

## Story

**As a** framework user,
**I want** detailed recommendation reasoning and confirmation before applying a workflow,
**so that** I understand why a workflow was recommended and can confirm or override the selection.

## Acceptance Criteria

1. Recommendation message includes detailed reasoning (why this workflow was chosen)
2. Workflow selection confirmation prompt is implemented
3. Workflow auto-loading works after confirmation
4. Option to override recommendation is supported
5. Override allows manual workflow selection
6. Confirmation can be skipped (non-interactive mode)

## Tasks / Subtasks

- [x] Task 1: Enhance recommendation message (AC: 1)
  - [x] Add detailed reasoning to message (via WorkflowRecommender)
  - [x] Explain recommendation factors (confidence, track, project type)
  - [x] Include confidence level
  - [x] Format message clearly

- [x] Task 2: Add confirmation prompt (AC: 2)
  - [x] Create confirmation prompt
  - [x] Support yes/no/override answers
  - [x] Handle user input

- [x] Task 3: Implement auto-loading (AC: 3)
  - [x] Load workflow after confirmation
  - [x] Integrate with workflow executor
  - [x] Handle loading errors

- [x] Task 4: Support override (AC: 4, 5)
  - [x] Add override option (option 'o')
  - [x] Allow manual workflow selection
  - [x] List available workflows
  - [x] Support workflow selection

- [x] Task 5: Support skip (AC: 6)
  - [x] Allow confirmation skip (non-interactive mode)
  - [x] Use default behavior if skipped
  - [x] Document skip behavior

## Dev Notes

### Existing System Context

- WorkflowRecommender provides messages
- Workflow executor exists
- CLI confirmation patterns
- Workflow loading exists

### Integration Approach

- Enhance recommender message
- Add confirmation to CLI command
- Integrate with workflow executor
- Follow CLI confirmation patterns

### Risk Assessment

- **Primary risk**: Auto-loading may be unexpected
  - **Mitigation**: Clear confirmation, skip option, manual override

### Rollback Plan

- Remove auto-loading
- Keep recommendation only
- No breaking changes

### Testing

- Test recommendation message
- Test confirmation prompt
- Test auto-loading
- Test override functionality
- Test skip behavior

## Change Log

| Date       | Version | Description                     | Author      |
| ---------- | ------- | ------------------------------- | ----------- |
| 2025-01-XX | 0.1     | Initial draft for Epic 33.4     | bmad-master |

## Dev Agent Record

**Implementation Complete:**
- Enhanced recommendation message includes confidence, track, and project type (from WorkflowRecommender)
- Added confirmation prompt with options: [y/N/o] (yes, no, override)
- Auto-loading implemented with `--auto-load` flag, integrates with WorkflowExecutor
- Override functionality allows manual workflow selection from available workflows list
- Confirmation skipped in non-interactive mode

**Files Modified:**
- `tapps_agents/cli/commands/top_level.py` - Added confirmation and override logic

## QA Results

_TBD_

