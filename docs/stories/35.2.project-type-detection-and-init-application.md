# Story 35.2: Project Type Detection + Init Application

<!-- Source: docs/prd/epic-3-adaptive-configuration-and-templates.md -->
<!-- Context: Detect project archetype and apply project-type templates during init -->

## Status

**Completed** (2025-12-17)

## Story

**As a** framework user,  
**I want** the system to detect (or ask me to confirm) my project type and apply the corresponding project-type template during `tapps-agents init`,  
**so that** I get correct defaults automatically with a transparent, safe preview.

## Acceptance Criteria

1. Project type can be determined from repo signals (or confirmed interactively when ambiguous)
2. Init applies the selected project-type template in a defined merge order with defaults + tech-stack templates + user overrides
3. Init output clearly shows:
   - detected/selected project type
   - which template was applied
   - where to override the result
4. System supports an explicit override (config flag or CLI option) to force project type selection
5. Backward compatible: init works when no project-type templates exist or detection is disabled
6. Tests cover detection heuristics, ambiguous cases, and merge-order correctness

## Tasks / Subtasks

- [x] Task 1: Define detection heuristics and signals (AC: 1, 6)
  - [x] Identify common signals (dependency manifests, directory structure, entrypoints, CI config)
  - [ ] Implement "ambiguous" detection and ask user to confirm in interactive mode (deferred - basic detection implemented)

- [x] Task 2: Implement selection + merge order (AC: 2, 5, 6)
  - [x] Add project-type template selection step
  - [x] Define merge precedence (recommended):
    - defaults < project-type template < tech-stack template(s) < user config/customizations
  - [x] Ensure deterministic results

- [ ] Task 3: CLI/UX output + explicit override (AC: 3, 4)
  - [ ] Add CLI flags or config options to force project type (deferred - detection integrated into init)
  - [x] Print clear init summary including applied template(s) (via template_info return value)

## Dev Notes

### Existing System Context

- Template selection and merging exist for tech-stack templates (see `docs/stories/31.2.template-selection-logic.md`, `docs/stories/31.3.template-merging-system.md`)
- Init integration exists for applying templates (see `docs/stories/31.4.init-integration.md`)

### Integration Approach

- Implement a parallel selector for project-type templates (mirrors tech-stack selector)
- Favor “confirm when ambiguous” to avoid surprising config changes
- Ensure the merge order is documented and consistent with customization precedence

## Change Log

| Date       | Version | Description              | Author      |
| ---------- | ------- | ------------------------ | ----------- |
| 2025-12-17 | 0.1     | Initial draft for Epic 3 | bmad-master |

## Dev Agent Record

### Agent Model Used

_TBD_

### Debug Log References

_TBD_

### Completion Notes List

_TBD_

### File List

- `tapps_agents/core/project_type_detector.py` - Project type detection module with heuristics for 5 archetypes
- `tapps_agents/core/init_project.py` - Updated to detect and apply project-type templates before tech-stack templates

## QA Results

_TBD_


