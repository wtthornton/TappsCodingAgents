# Story 30.5: Priority Testing & Documentation

<!-- Source: implementation/EPIC_02_Tech_Stack_Specific_Expert_Prioritization.md -->
<!-- Context: Brownfield enhancement - Testing and documentation for priority system -->

## Status

**Ready for Review**

## Story

**As a** framework user,
**I want** comprehensive testing and documentation for the expert priority system,
**so that** I understand how to use and configure priorities, and the system is reliable.

## Acceptance Criteria

1. Unit tests cover priority mapping lookup for all defined stacks
2. Unit tests cover priority application in expert registry
3. Unit tests cover priority override functionality
4. Integration tests verify priority system end-to-end (detection → config → registry → consultation)
5. Priority configuration format is documented with examples
6. Documentation includes examples for common tech stacks (FastAPI, React, etc.)
7. Documentation explains how to override default priorities
8. Documentation includes troubleshooting section

## Tasks / Subtasks

- [x] Task 1: Unit tests for mapping (AC: 1)
  - [x] Test priority mapping for FastAPI
  - [x] Test priority mapping for Django
  - [x] Test priority mapping for React
  - [x] Test priority mapping for Next.js
  - [x] Test unknown framework handling

- [x] Task 2: Unit tests for registry (AC: 2)
  - [x] Test expert ordering with priorities
  - [x] Test priority loading from config
  - [x] Test priority application to expert list
  - [x] Test backward compatibility (no priorities)

- [x] Task 3: Unit tests for overrides (AC: 3)
  - [x] Test priority override from config
  - [x] Test override precedence
  - [x] Test invalid override handling

- [x] Task 4: Integration tests (AC: 4)
  - [x] Test full flow: detection → config → registry → consultation
  - [x] Test with multiple frameworks
  - [x] Test with overrides
  - [x] Test without priorities

- [x] Task 5: Create documentation (AC: 5, 6, 7, 8)
  - [x] Document priority configuration format
  - [x] Add examples for FastAPI project
  - [x] Add examples for React project
  - [x] Document override process
  - [x] Add troubleshooting section

## Dev Notes

### Existing System Context

- Test structure exists in `tests/` directory
- Documentation structure exists in `docs/` directory
- Existing test patterns to follow
- Existing documentation patterns to follow

### Integration Approach

- Add tests to `tests/unit/core/` for priority mapping
- Add tests to `tests/unit/experts/` for registry integration
- Add integration tests to `tests/integration/`
- Create documentation in `docs/` following existing patterns

### Risk Assessment

- **Primary risk**: Tests may be incomplete
  - **Mitigation**: Comprehensive test coverage, edge cases, integration tests
- **Primary risk**: Documentation may be unclear
  - **Mitigation**: Examples, clear explanations, user feedback

### Rollback Plan

- Tests and documentation are additive
- No breaking changes

### Testing

- Run all new tests
- Verify test coverage
- Review documentation for clarity
- Test examples in documentation

## Change Log

| Date       | Version | Description                     | Author      |
| ---------- | ------- | ------------------------------- | ----------- |
| 2025-01-XX | 0.1     | Initial draft for Epic 30.5     | bmad-master |

## Dev Agent Record

### Agent Model Used

claude-sonnet-4-5

### Debug Log References

_TBD_

### Completion Notes List

- Comprehensive unit tests created for priority mapping (22 tests, all passing)
- Unit tests for expert registry priority integration (9 tests, all passing)
- Unit tests for config persistence (10 tests, all passing)
- Integration tests for end-to-end flow (5 tests, all passing)
- Complete documentation guide created with examples, troubleshooting, and best practices
- All tests cover edge cases, backward compatibility, and error handling

### File List

- `tests/unit/core/test_tech_stack_priorities.py` - Unit tests for priority mapping
- `tests/unit/core/test_tech_stack_config_persistence.py` - Unit tests for config persistence
- `tests/unit/experts/test_expert_registry_priorities.py` - Unit tests for registry integration
- `tests/integration/test_tech_stack_priority_integration.py` - Integration tests for full flow
- `docs/TECH_STACK_EXPERT_PRIORITIES_GUIDE.md` - Comprehensive documentation guide

## QA Results

_TBD_

