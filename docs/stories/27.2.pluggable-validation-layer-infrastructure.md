# Story 27.2: Pluggable Validation Layer Infrastructure

<!-- Source: docs/prd/epic-1-sdlc-quality-engine.md -->
<!-- Context: SDLC Quality Engine Improvements - Validation Foundation -->

## Status

**Draft** - Not Implemented

**Last Updated:** 2025-01-XX

**Implementation Notes:**
- No pluggable validation layer infrastructure found in codebase
- No validator registry or abstract base class for validators
- Project profile system exists (`tapps_agents/core/project_profile.py`) but no validation layer integration
- Repo signal detection not implemented

## Story

**As a** SDLC workflow system,
**I want** a pluggable validation layer that automatically loads validators based on detected project stack,
**so that** the SDLC can adapt to any technology stack and run appropriate validation checks without manual configuration.

## Acceptance Criteria

1. Validation interface/abstract base class created for validators
2. Validator registry implemented that loads validators based on project profile
3. Repo signal detection implemented (languages, frameworks, dependency manifests, build/test tooling, CI config)
4. Default validator plugin set created (Python, TypeScript, general-purpose)
5. Validators load correctly based on project profile
6. Repo signals correctly detected for common stacks
7. Default validators work for common technology stacks

## Tasks / Subtasks

- [ ] Task 1: Create Validation Interface (AC: 1)
  - [ ] Design abstract base class for validators
  - [ ] Define validation contract (validate method, issue emission)
  - [ ] Create validator lifecycle hooks (initialize, cleanup)
  - [ ] Document validator interface specification

- [ ] Task 2: Implement Validator Registry (AC: 2, 5)
  - [ ] Create validator registry class
  - [ ] Implement validator discovery mechanism
  - [ ] Add validator loading based on project profile
  - [ ] Add validator priority/ordering system
  - [ ] Create validator registration utilities

- [ ] Task 3: Implement Repo Signal Detection (AC: 3, 6)
  - [ ] Detect programming languages from file extensions and patterns
  - [ ] Detect frameworks from dependency manifests and config files
  - [ ] Detect build tooling (package.json, pyproject.toml, Makefile, etc.)
  - [ ] Detect test tooling (pytest, jest, etc.)
  - [ ] Detect CI config files (GitHub Actions, GitLab CI, etc.)
  - [ ] Create signal aggregation and normalization

- [ ] Task 4: Create Default Validator Plugins (AC: 4, 7)
  - [ ] Implement Python validator plugin
  - [ ] Implement TypeScript/JavaScript validator plugin
  - [ ] Implement general-purpose validator plugin
  - [ ] Add validator configuration system
  - [ ] Test validators with sample projects

- [ ] Task 5: Integration & Testing (AC: 5, 6, 7)
  - [ ] Integration tests with project profile system
  - [ ] Test validator loading for multiple stacks
  - [ ] Test repo signal detection accuracy
  - [ ] Test default validators with real projects

## Dev Notes

**Integration Points:**
- Project profile system: `tapps_agents/core/project_profile.py`
- Project profile file: `.tapps-agents/project-profile.yaml`
- Workflow executor: `tapps_agents/workflow/executor.py`
- Issues Manifest: Story 27.1 output

**Technology Stack:**
- Python 3.13+
- Existing project profiling infrastructure
- Plugin pattern (consider using entry points or similar)

**Key Constraints:**
- Validators must be stack-agnostic in interface
- Registry must support dynamic loading
- Signal detection must be fast and non-intrusive
- Validators must emit Issues Manifest format (from Story 1.1)

**Testing Standards:**
- Test file location: `tests/unit/test_validation_layer.py`
- Test with multiple project types
- Validate signal detection accuracy
- Test validator plugin loading

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Initial story creation | BMad Master |

## Dev Agent Record

### Agent Model Used

_To be populated by dev agent_

### Debug Log References

_To be populated by dev agent_

### Completion Notes List

_To be populated by dev agent_

### File List

_To be populated by dev agent_

## QA Results

_To be populated by QA agent_

