# TappsCodingAgents - Default Configuration Template
# 
# Recommended: run `tapps-agents init` (or `python -m tapps_agents.cli init`) to create
# `.tapps-agents/config.yaml` and install Cursor Rules, Skills, and workflow presets.
#
# If you want to copy manually, copy this file to `.tapps-agents/config.yaml` in your
# project root and customize as needed.

# Project metadata (optional)
project_name: null
version: null

# Tooling targets (used by `doctor` for environment checks)
tooling:
  targets:
    python: 3.13.3
    python_requires: ">=3.13"
    os_targets: ["windows", "linux"]
  policy:
    external_tools_mode: soft
    mypy_staged: true
    mypy_stage_paths: ["tapps_agents/core", "tapps_agents/workflow", "tapps_agents/context7"]

# Agent configurations
agents:
  reviewer:
    model: "qwen2.5-coder:7b"           # LLM model for code reviews
    quality_threshold: 70.0              # Minimum score (0-100) to pass review
    include_scoring: true                # Include code scoring in review
    include_llm_feedback: true           # Include LLM-generated feedback
    max_file_size: 1048576               # Maximum file size in bytes (1MB)
  
  planner:
    model: "qwen2.5-coder:7b"           # LLM model for planning
    stories_dir: "stories"               # Directory for storing stories
    default_priority: "medium"           # Default priority for new stories (high/medium/low)
  
  implementer:
    model: "qwen2.5-coder:7b"           # LLM model for code generation
    require_review: true                 # Require code review before writing files
    auto_approve_threshold: 80.0         # Auto-approve if score >= threshold (0-100)
    backup_files: true                   # Create backup before overwriting existing files
    max_file_size: 10485760              # Maximum file size in bytes (10MB)
  
  tester:
    model: "qwen2.5-coder:7b"           # LLM model for test generation
    test_framework: "pytest"             # Test framework to use (pytest/unittest)
    tests_dir: null                      # Directory for tests (default: tests/)
    coverage_threshold: 80.0             # Target test coverage percentage (0-100)
    auto_write_tests: true               # Automatically write generated tests to files
  
  debugger:
    model: "deepseek-coder:6.7b"        # LLM model for error analysis
    include_code_examples: true          # Include code examples in fix suggestions
    max_context_lines: 50                # Maximum lines of code context to include in analysis (10-200)
  
  documenter:
    model: "qwen2.5-coder:7b"           # LLM model for documentation generation
    docs_dir: null                       # Directory for generated docs (default: docs/)
    include_examples: true               # Include code examples in documentation
    docstring_format: "google"           # Docstring format (google/numpy/sphinx)

# Code scoring configuration
scoring:
  weights:
    complexity: 0.18                     # Weight for complexity score (all 7 must sum to 1.0)
    security: 0.27                       # Weight for security score
    maintainability: 0.24                # Weight for maintainability score
    test_coverage: 0.13                  # Weight for test coverage score
    performance: 0.08                    # Weight for performance score
    structure: 0.05                      # Weight for structure score (project layout, key files)
    devex: 0.05                          # Weight for developer experience (docs, config, tooling)
  quality_threshold: 70.0                # Minimum overall score (0-100) to pass

# Expert consultation system configuration
expert:
  # Agent-specific confidence thresholds (0.0-1.0)
  agent_confidence_thresholds:
    reviewer: 0.8        # High threshold for code reviews
    architect: 0.75       # High for architecture decisions
    implementer: 0.7      # Medium-high for code generation
    designer: 0.65        # Medium for design decisions
    tester: 0.7          # Medium-high for test generation
    ops: 0.75            # High for operations
    enhancer: 0.6         # Medium for enhancements
    analyst: 0.65         # Medium for analysis
    planner: 0.6          # Medium for planning
    debugger: 0.7         # Medium-high for debugging
    documenter: 0.5       # Lower for documentation (less critical)
    orchestrator: 0.6     # Medium for orchestration
    default: 0.7          # Default threshold
  
  # Confidence calculation weights (must sum to 1.0)
  weight_max_confidence: 0.35      # Weight for maximum expert confidence
  weight_agreement: 0.25          # Weight for expert agreement level
  weight_rag_quality: 0.2         # Weight for RAG knowledge base quality
  weight_domain_relevance: 0.1     # Weight for domain relevance
  weight_project_context: 0.1      # Weight for project context relevance
  
  # Agreement and similarity thresholds (0.0-1.0)
  high_agreement_threshold: 0.75   # High agreement threshold for expert consensus
  similarity_threshold: 0.6         # Similarity threshold for expert response comparison
  
  # RAG (Retrieval-Augmented Generation) parameters
  rag_max_length: 2000             # Maximum length for RAG context retrieval (characters)
  rag_max_results: 5               # Maximum number of RAG results to retrieve
  rag_default_quality: 0.8         # Default RAG quality score when not provided
  
  # Profile confidence threshold (0.0-1.0)
  profile_confidence_threshold: 0.7 # Minimum confidence for including profile values
  
  # Supporting expert weight (0.0-1.0)
  supporting_expert_weight: 0.15   # Approximate weight for supporting experts

# Workflow execution configuration
workflow:
  auto_execution_enabled: true      # Enable Background Agent auto-execution (default: true for better UX)
  polling_interval: 5.0             # Seconds between status checks when polling for completion
  timeout_seconds: 3600.0            # Maximum time to wait for step completion (seconds)

# Continuous Bug Fix configuration
continuous_bug_fix:
  max_iterations: 10                # Maximum loop iterations (1-100)
  commit_strategy: "one-per-bug"    # Commit strategy: "one-per-bug" or "batch"
  auto_commit: true                  # Automatically commit fixes after bug-fix-agent succeeds
  test_path: "tests/"                # Default test directory or file to run
  skip_patterns: []                  # Patterns for bugs to skip (not yet implemented)