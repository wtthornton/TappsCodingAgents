{
  "library": "worktree",
  "topic": "best-practices",
  "documentation": {
    "content": "## Multi-Agent Workflow Example with Treehouse CLI\n\n```bash\n# Agent 1 starts working on API\ntreehouse create api-work --agent agent-1 --message \"Implementing REST endpoints\"\n\n# Agent 2 starts working on UI (different worktree)\ntreehouse create ui-work --agent agent-2 --message \"Building dashboard components\"\n\n# Check what's being worked on\ntreehouse list\n\n# Agent 1 finishes and merges\ntreehouse complete api-work --merge --delete-branch\ntreehouse remove api-work\n\n# Agent 2 finishes\ntreehouse complete ui-work --merge\ntreehouse remove ui-work\n```\n\n## Programmatic Worktree Management with Treehouse Library\n\n```typescript\nimport { treehouse } from 'treehouse-worktree';\n\n// Create a worktree\nconst result = await treehouse.create({\n  name: 'feature-api',\n  agentId: 'my-agent',\n  lockMessage: 'Working on API'\n});\n\n// List worktrees\nconst list = await treehouse.list();\n\n// Complete work\nawait treehouse.complete({\n  name: 'feature-api',\n  merge: true,\n  deleteBranch: true\n});\n```\n\n## Setup Commands for Worktree\n\n```json\n{\n  \"setup-worktree\": [\n    \"npm install\",\n    \"cp $ROOT_WORKTREE_PATH/.env .env\"\n  ]\n}\n```\n\n## Available MCP Tools for Treehouse\n\n```typescript\n// Available tools in MCP server\nconst tools = [\n  { name: 'treehouse_init', description: 'Initialize configuration' },\n  { name: 'treehouse_list', description: 'List all worktrees' },\n  { name: 'treehouse_create', description: 'Create new worktree' },\n  { name: 'treehouse_status', description: 'Get worktree status' },\n  { name: 'treehouse_complete', description: 'Complete and merge work' },\n  { name: 'treehouse_remove', description: 'Remove worktree' },\n  { name: 'treehouse_lock', description: 'Lock worktree' },\n  { name: 'treehouse_unlock', description: 'Unlock worktree' },\n  { name: 'treehouse_conflicts', description: 'Check conflicts' },\n  { name: 'treehouse_resolve', description: 'Resolve conflicts' },\n  { name: 'treehouse_abort', description: 'Abort merge' },\n  { name: 'treehouse_prune', description: 'Prune orphaned entries' },\n  { name: 'treehouse_clean', description: 'Clean old worktrees' }\n];\n\n// Example: Merge with conflict resolution\n// 1. Complete the worktree with merge\ntreehouse_complete({ name: 'feature-api', merge: true })\n\n// 2. If conflicts occur, check them\ntreehouse_conflicts({ name: 'feature-api' })\n\n// 3. Resolve using strategy\ntreehouse_resolve({ name: 'feature-api', strategy: 'theirs' })\n```\n\n## treehouse-worktree Configuration File Example\n\n```json\n{\n  \"dir\": \"../worktrees\",\n  \"defaultTargetBranch\": \"current\",\n  \"lockExpiryMinutes\": 60,\n  \"setup-worktree\": [\n    \"npm install\",\n    \"cp \\\"$ROOT_WORKTREE_PATH/.env\\\" .env\"\n  ],\n  \"worktree.cleanup.enabled\": true,\n  \"worktree.cleanup.retentionDays\": 7,\n  \"worktree.cleanup.maxSizeGB\": 10\n}\n```\n\n## Platform-Specific Setup Commands in Configuration\n\n```json\n{\n  \"setup-worktree\": [\n    \"# Install dependencies\",\n    \"npm install\",\n    \"# Copy environment file from main repo\",\n    \"cp $ROOT_WORKTREE_PATH/.env .env\",\n    \"# Generate prisma client\",\n    \"npx prisma generate\"\n  ],\n  \"setup-worktree-unix\": \"./scripts/setup-worktree.sh\",\n  \"setup-worktree-windows\": \"./scripts/setup-worktree.ps1\"\n}\n```\n\n## Maintenance Commands for treehouse-worktree\n\n```bash\n# Prune orphaned worktree entries\ntreehouse prune\n\n# Clean old worktrees (based on config)\ntreehouse clean --dry-run   # preview\ntreehouse clean             # actually remove\n```\n\n## Detect and Resolve Merge Conflicts\n\n```APIDOC\n## Detect and Resolve Merge Conflicts\n\n### Description\nChecks for merge conflicts in a worktree and provides resolution strategies. Supports automatic resolution using 'ours' or 'theirs' strategy.\n\n### Method\nVarious (internal API calls represented by `treehouse.conflicts`, `treehouse.resolveConflicts`, and `treehouse.abort` in TypeScript SDK)\n\n### Parameters\n#### Conflicts Check Parameters\n- **name** (string) - Required - The name of the worktree to check for conflicts.\n\n#### Resolve Conflicts Parameters\n- **name** (string) - Required - The name of the worktree to resolve conflicts in.\n- **strategy** (string) - Required - The resolution strategy ('ours' or 'theirs').\n\n### Request Example (Check Conflicts)\n```typescript\nawait treehouse.conflicts('feature-api');\n```\n\n### Request Example (Resolve Conflicts)\n```typescript\nawait treehouse.resolveConflicts({\n  name: 'feature-api',\n  strategy: 'theirs'\n});\n```\n\n### Request Example (Abort Merge)\n```typescript\nawait treehouse.abort('feature-api');\n```\n\n### Response\n#### Success Response (Conflicts Check)\n- **success** (boolean) - True if the conflict check was successful.\n- **data** (object) - Contains conflict information if successful.\n  - **conflicts** (array of strings) - A list of files with merge conflicts.\n\n#### Success Response (Resolve Conflicts)\n- **success** (boolean) - True if conflicts were resolved successfully.\n\n#### Success Response (Abort Merge)\n- **success** (boolean) - True if the merge was aborted successfully.\n\n#### Response Example (Conflicts Found)\n{\n  \"success\": true,\n  \"data\": {\n    \"conflicts\": [\"src/file.js\"]\n  }\n}\n\n#### Response Example (No Conflicts)\n{\n  \"success\": true,\n  \"data\": {\n    \"conflicts\": []\n  }\n}\n\n#### Response Example (Resolve Success)\n{\n  \"success\": true\n}\n```\n\n## Completing and Merging Work with treehouse-worktree\n\n```bash\n# Just mark as complete (no merge)\ntreehouse complete feature-api\n\n# Merge into current branch\ntreehouse complete feature-api --merge\n\n# Squash merge with custom message\ntreehouse complete feature-api --merge --squash --message \"Add new API endpoints\"\n\n# Merge and delete branch\ntreehouse complete feature-api --merge --delete-branch\n\n# Merge into specific branch\ntreehouse complete feature-api --merge --target main\n```\n\n## Configuration File\n\n```APIDOC\n## Configuration File\n\n### Configuration options and setup commands\n\nTreehouse supports both treehouse.json and .cursor/worktrees.json for Cursor IDE compatibility. Configuration includes worktree directory location, lock expiry, setup commands, and cleanup policies.\n\n```json\n{\n  \"dir\": \"../worktrees\",\n  \"defaultTargetBranch\": \"current\",\n  \"lockExpiryMinutes\": 60,\n  \"setup-worktree\": [\n    \"npm install\",\n    \"cp \\\"$ROOT_WORKTREE_PATH/.env\\\" .env\",\n    \"npm run build\"\n  ],\n  \"setup-worktree-unix\": [\n    \"npm ci\",\n    \"bash scripts/setup.sh\"\n  ],\n  \"setup-worktree-windows\": [\n    \"npm ci\",\n    \"powershell .\\scripts\\setup.ps1\"\n  ],\n  \"worktree.cleanup.enabled\": true,\n  \"worktree.cleanup.retentionDays\": 7,\n  \"worktree.cleanup.maxSizeGB\": 10\n}\n```\n\n### Platform-specific setup and environment variables\n\nSetup commands support platform-specific configuration, external script files, and environment variables for flexible initialization.\n\n```json\n{\n  \"setup-worktree\": [\n    \"# Install dependencies\",\n    \"npm install\",\n    \"# Copy environment file from main repo\",\n    \"cp $ROOT_WORKTREE_PATH/.env .env\",\n    \"# Generate prisma client\",\n    \"npx prisma generate\"\n  ],\n  \"setup-worktree-unix\": \"./scripts/setup-worktree.sh\",\n  \"setup-worktree-windows\": \"./scripts/setup-worktree.ps1\"\n}\n```\n```",
    "library": "worktree_manager",
    "topic": "best-practices",
    "source": "fuzzy_match"
  },
  "source": "fuzzy_match",
  "saved_at": "2026-01-30T18:29:55.021531"
}