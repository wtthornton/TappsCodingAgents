{
  "library": "prompt_base",
  "topic": "best-practices",
  "documentation": {
    "content": "## Directus Schema Sync Configuration Example (V2 to V3 Migration)\n\n```javascript\ndirectus_roles: {\n\t\twatch: ['roles'],\n\t\tlinkedFields: ['parent'],\n\t\tquery: {\n\t\t\tsort: ['name']\n\t\t}\n\t},\n\tdirectus_policies: {\n\t\twatch: ['policies'],\n\t\tquery: {\n\t\t\tsort: ['name']\n\t\t}\n\t},\n\tdirectus_permissions: {\n\t\twatch: ['permissions', 'collections', 'fields'],\n\t\texcludeFields: ['id'],\n\t\tgetKey: o => `${o.policy}-${o.collection}-${o.action}`,\n\t\tquery: {\n\t\t\tsort: ['policy', 'collection', 'action']\n\t\t}\n\t},\n\tdirectus_access: {\n\t\twatch: ['access'],\n\t\texcludeFields: ['id'],\n\t\tgetKey: o => `${o.role ?? o.user ?? 'public'}-${o.policy}`,\n\t\tquery: {\n\t\t\tsort: ['role', 'policy'],\n\t\t\tfilter: {\n\t\t\t\tuser: { _null: true }\n\t\t\t}\n\t\t}\n\t}\n```\n\n## Install Directus Schema Sync Extension (NPM)\n\n```bash\nnpm install directus-extension-schema-sync\ndirectus schema-sync install\n```\n\n## Directus Schema Sync CLI Commands\n\n```APIDOC\nnpx directus schema-sync [command]\n\nCommands:\n  export\n    Export the schema and data from the Directus API.\n\n  import\n    Import the schema and data to the Directus API.\n    Options: merge, data.\n\n  hash\n    Recalculate the hash for all the data files (already happens after export).\n\n  install\n    Install the extension's columns in the database and add the config folder.\n    Options: force.\n\n  export-schema\n    Export only the schema.\n    Options: --split <boolean>.\n\n  import-schema\n    Import only the schema.\n```\n\n## Custom Directus User Export/Import Logic\n\n```javascript\nonExport: async (item, itemsSrv) => {\n\tif (item.password && item.password === '**********') {\n\t\tconst user = await itemsSrv.knex.select('password').from('directus_users').where('id', item.id).first();\n\t\tif (user) {\n\t\t\titem.password = user.password;\n\t\t}\n\t}\n\n\treturn item;\n}\n```\n\n## Custom Directus User Export/Import Logic\n\n```javascript\nonImport: async (item, itemsSrv) => {\n\tif (item.password && item.password.startsWith('$argon')) {\n\t\tawait itemsSrv.knex('directus_users').update('password', item.password).where('id', item.id);\n\t\titem.password = '**********';\n\t}\n\n\treturn item;\n}\n```\n\n## Install Directus Schema Sync Extension (Docker)\n\n```bash\ndocker compose exec -it my-directus npx directus schema-sync install --force\n```\n\n## Install Directus Schema Sync via Docker\n\n```dockerfile\nRUN pnpm install directus-extension-schema-sync\n# This is for when building for production\nCOPY ./schema-sync ./schema-sync\n```\n\n## Export Schema and Data (NPM)\n\n```bash\ndirectus schema-sync export\n```\n\n## Mount Schema Sync Volume in Docker Compose\n\n```yaml\nvolumes:\n  - ./schema-sync:/directus/schema-sync\n```",
    "library": "export_schema",
    "topic": "best-practices",
    "source": "fuzzy_match"
  },
  "source": "fuzzy_match",
  "saved_at": "2026-01-30T18:32:48.910218"
}