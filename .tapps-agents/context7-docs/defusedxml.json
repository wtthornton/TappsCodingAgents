{
  "library": "defusedxml",
  "topic": null,
  "documentation": {
    "content": "## JavaScript Functions for Host History Navigation and Data Display\n\n```javascript\nfunction click_next(event) { var n = parseInt($('#page_number').text()) + 1; set_page(n); }\nfunction click_prev(event) { var n = parseInt($('#page_number').text()) - 1; set_page(n); }\nfunction set_page(n) { if (n<0 || n>=data.length) return;\n$('#page_number').text( n );\n$('#start_time').text( data[n]['stats']['start_time'] );\n$('#cpu_percent').text( data[n]['stats']['cpu_percent'] );\n$('#mem_percent').text( data[n]['stats']['mem_percent'] );\nvar plist = [];\nfor(var i=0; i < data[n]['processes'].length; i++){\n  p = data[n]['processes'][i];\n  plist.push(\"<tr><td>\" + p['pid'] + \"</td><td>\" + p['name'] + \"</td><td>\" + p['user'] + \"</td><td>\" + p['system'] + \"</td><td>\" + p['rss'] + \"</td></tr>\")\n}\n$(\"#process_list > tbody:last-child\").html( plist.join(\"\\n\"));\n}\n$(document).ready(function() {\n  $('#next').on('click', click_next);\n  $('#prev').on('click', click_prev);\n  $(document).keydown(function(e) {\n    switch(e.which) {\n      case 37: // left\n        click_prev(e);\n        break;\n      case 38: // up\n        break;\n      case 39: // right\n        click_next(e);\n        break;\n      case 40: // down\n        break;\n      default:\n        return; // exit this handler for other keys\n    }\n    e.preventDefault(); // prevent the default action (scroll / move caret)\n  });\n});\n```\n\n## Iterative Parsing with Objects API (Python)\n\n```python\nimport dfxml.objects as Objects\n\n# This code snippet is incomplete in the provided text and only demonstrates the import.\n```\n\n## Iterate Over File Objects (Python)\n\n```python\nimport dfxml\n\n# Iterate through file objects in a DFXML file\nfor fileobject in dfxml.iter_dfxml(xmlfile=open('forensic_image.xml', 'rb')):\n    if fileobject.is_file() and fileobject.allocated():\n        print(f\"{fileobject.filename()}: {fileobject.filesize()} bytes\")\n\n        # Access file times\n        if fileobject.mtime():\n            print(f\"  Modified: {fileobject.mtime().iso8601()}\")\n        if fileobject.atime():\n            print(f\"  Accessed: {fileobject.atime().iso8601()}\")\n\n        # Check for specific file extensions\n        if fileobject.ext() == 'pdf':\n            print(f\"  Found PDF: {fileobject.filename()}\")\n```\n\n## Type-Safe Parsing with Objects API (Python)\n\n```python\nimport dfxml.objects as Objects\n\n# Parse entire DFXML document into memory\ndfxml_doc = Objects.parse('forensic_image.xml')\n\nprint(f\"DFXML Version: {dfxml_doc.version}\")\nprint(f\"Creator: {dfxml_doc.program} {dfxml_doc.program_version}\")\n\n# Iterate through volumes\nfor volume in dfxml_doc.volumes:\n    print(f\"\\nVolume: {volume.ftype_str}\")\n    print(f\"  Block size: {volume.block_size}\")\n    print(f\"  Block count: {volume.block_count}\")\n\n    # Iterate through files in volume\n    for fileobj in volume.files:\n        if fileobj.filename and fileobj.filesize:\n            print(f\"  File: {fileobj.filename} ({fileobj.filesize} bytes)\")\n\n            # Access timestamps as properties\n            if fileobj.mtime:\n                print(f\"    Modified: {fileobj.mtime}\")\n\n            # Access hash values\n            if fileobj.sha256:\n                print(f\"    SHA-256: {fileobj.sha256}\")\n```\n\n## Analyzing File Fragmentation with Byte Runs in Python\n\n```python\nimport dfxml\n\ndef analyze_fragmentation(fileobject):\n    \"\"\"Analyze file fragmentation using byte runs\"\"\"\n    filename = fileobject.filename()\n    byte_runs = fileobject.byte_runs()\n\n    if len(byte_runs) > 1:\n        print(f\"{filename} is fragmented:\")\n        print(f\"  Number of fragments: {len(byte_runs)}\")\n\n        total_size = 0\n        for i, run in enumerate(byte_runs):\n            print(f\"  Fragment {i+1}:\")\n            print(f\"    Disk offset: {run.img_offset}\")\n            print(f\"    Length: {run.len} bytes\")\n            total_size += run.len\n\n        print(f\"  Total size: {total_size} bytes\")\n\n# Process DFXML file\nwith open('forensic_image.xml', 'rb') as xmlfile:\n    dfxml.read_dfxml(xmlfile=xmlfile, callback=analyze_fragmentation)\n```\n\n## Iterative DFXML Processing with Python\n\n```python\nfrom dfxml import objects as Objects\n\n# Process DFXML file iteratively\nfor event, obj in Objects.iterparse('forensic_image.xml', events=('start', 'end')):\n    if event == 'start' and isinstance(obj, Objects.VolumeObject):\n        print(f\"Starting volume: {obj.ftype_str}\")\n\n    elif event == 'end' and isinstance(obj, Objects.FileObject):\n        # Process file objects as they complete\n        if obj.allocated_inode and obj.filesize and obj.filesize > 1048576:\n            print(f\"Large file: {obj.filename} ({obj.filesize} bytes)\")\n\n            # Check for suspicious characteristics\n            if obj.compressed:\n                print(f\"  Compressed: True\")\n            if obj.encrypted:\n                print(f\"  Encrypted: True\")\n```\n\n## Compare File Systems using Differential DFXML\n\n```python\nimport dfxml.objects as Objects\n\n# Parse original and new file system snapshots\noriginal = Objects.parse('snapshot_before.xml')\ncurrent = Objects.parse('snapshot_after.xml')\n\n# Build lookup dictionary for original files\noriginal_files = {}\nfor fileobj in original.files:\n    if fileobj.filename:\n        original_files[fileobj.filename] = fileobj\n\n# Compare and identify changes\nnew_files = []\nmodified_files = []\ndeleted_files = set(original_files.keys())\n\nfor fileobj in current.files:\n    filename = fileobj.filename\n\n    if filename in original_files:\n        deleted_files.remove(filename)\n        orig = original_files[filename]\n\n        # Compare hashes to detect modifications\n        if fileobj.md5 and orig.md5() and fileobj.md5 != orig.md5():\n            modified_files.append({\n                'filename': filename,\n                'old_size': orig.filesize(),\n                'new_size': fileobj.filesize,\n                'old_mtime': orig.mtime(),\n                'new_mtime': fileobj.mtime\n            })\n    else:\n        new_files.append(filename)\n\n# Report results\nprint(f\"New files: {len(new_files)}\")\nfor f in new_files[:10]:\n    print(f\"  + {f}\")\n\nprint(f\"\\nModified files: {len(modified_files)}\")\nfor f in modified_files[:10]:\n    print(f\"  M {f['filename']}\")\n\nprint(f\"\\nDeleted files: {len(deleted_files)}\")\nfor f in list(deleted_files)[:10]:\n    print(f\"  - {f}\")\n```\n\n## Extract File Content from Disk Images using DFXML Byte Runs\n\n```python\nimport dfxml\nimport dfxml.objects as Objects\n\ndef extract_file_content(fileobject, image_path, output_path):\n    \"\"\"Extract file content using byte runs\"\"\"\n    if not fileobject.byte_runs():\n        print(\"No byte runs available\")\n        return\n\n    with open(image_path, 'rb') as disk_image:\n        with open(output_path, 'wb') as output_file:\n            for byte_run in fileobject.byte_runs():\n                if byte_run.img_offset and byte_run.len:\n                    # Seek to location on disk\n                    disk_image.seek(byte_run.img_offset)\n                    # Read and write data\n                    data = disk_image.read(byte_run.len)\n                    output_file.write(data)\n\n    print(f\"Extracted {fileobject.filename()} to {output_path}\")\n\n# Example: Extract a specific file\nwith open('forensic_image.xml', 'rb') as xmlfile:\n    for fileobject in dfxml.iter_dfxml(xmlfile):\n        if fileobject.filename() == '/important/document.pdf':\n            extract_file_content(fileobject, 'image.dd', 'extracted_document.pdf')\n            break\n```\n\n## Read DFXML with Callbacks (Python)\n\n```python\nimport dfxml\n\ndef process_file(fileobject):\n    \"\"\"Callback function to process each file object\"\"\"\n    print(f\"File: {fileobject.filename()}\")\n    print(f\"  Size: {fileobject.filesize()} bytes\")\n    print(f\"  MD5: {fileobject.md5()}\")\n    print(f\"  Modified: {fileobject.mtime()}\")\n    print(f\"  Allocated: {fileobject.allocated()}\")\n\n# Process DFXML file with callback\nwith open('forensic_image.xml', 'rb') as xmlfile:\n    dfxml.read_dfxml(xmlfile=xmlfile, callback=process_file)\n```\n\n## Filtering Files by Forensic Criteria in Python\n\n```python\nimport dfxml\n\ndeleted_files = []\nsuspicious_files = []\n\ndef filter_files(fileobject):\n    \"\"\"Filter files by forensic criteria\"\"\"\n    # Find deleted files\n    if not fileobject.allocated():\n        deleted_files.append({\n            'filename': fileobject.filename(),\n            'size': fileobject.filesize(),\n            'md5': fileobject.md5()\n        })\n\n    # Find executable files\n    if fileobject.ext() in ['exe', 'dll', 'sys']:\n        suspicious_files.append({\n            'filename': fileobject.filename(),\n            'size': fileobject.filesize(),\n            'sha256': fileobject.sha256()\n        })\n\n# Process DFXML\nwith open('forensic_image.xml', 'rb') as xmlfile:\n    dfxml.read_dfxml(xmlfile=xmlfile, callback=filter_files)\n```\n\nContext7 cache for defusedxml: cached at 2026-02-03T17:50:09.169750+00:00Z; consider refreshing if docs changed.",
    "library": "defusedxml",
    "topic": "overview",
    "source": "cache"
  },
  "source": "cache",
  "saved_at": "2026-02-03T09:50:09.229057"
}