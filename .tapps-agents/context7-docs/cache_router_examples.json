{
  "library": "cache_router",
  "topic": "examples",
  "documentation": {
    "content": "## Optimize Re-renders with Selectors in TanStack Router\n\n```tsx\n// Only re-render when specific nested values change\nfunction WidgetComponent({ widgetId }: { widgetId: string }) {\n  // Use selector to avoid unnecessary re-renders\n  const widget = Route.useSearch({\n    select: (search) => search.dashboard.widgets.find((w) => w.id === widgetId),\n  })\n\n  const layout = Route.useSearch({\n    select: (search) => search.dashboard.layout,\n  })\n\n  if (!widget) return null\n\n  return (\n    <div\n      style={{\n        gridColumn: `span ${Math.ceil(12 / layout.columns)}`,\n      }}\n    >\n      <h3>{widget.config.title}</h3>\n      {/* Widget content */}\n    </div>\n  )\n}\n```\n\n## Optimizing Performance with Selectors for Large Search Objects (TanStack Router)\n\n```tsx\n// Use selector to minimize re-renders\nconst onlyNeededData = Route.useSearch({\n  select: (search) => ({\n    currentPage: search.pagination.page,\n    pageSize: search.pagination.size,\n  }),\n})\n```\n\n## Fine-Grained Selector for Partial State Subscription\n\n```tsx\n// component won't re-render when `bar` changes\nconst foo = Route.useSearch({ select: ({ foo }) => foo })\n```\n\n## Enable Structural Sharing Per Hook Usage\n\n```tsx\nconst result = Route.useSearch({\n  select: (search) => {\n    return {\n      foo: search.foo,\n      hello: `hello ${search.foo}`,\n    }\n  },\n  structuralSharing: true,\n})\n```\n\n## Memoized Permission Computations - React Hooks\n\n```tsx\nimport { useMemo } from 'react'\n\nfunction usePermissions() {\n  const { auth } = Route.useRouteContext()\n\n  const permissions = useMemo(\n    () => ({\n      canEditUsers: auth.hasPermission('users:write'),\n      canDeleteUsers: auth.hasPermission('users:delete'),\n      isAdmin: auth.hasRole('admin'),\n      isModerator: auth.hasAnyRole(['admin', 'moderator']),\n    }),\n    [auth.user?.roles, auth.user?.permissions],\n  )\n\n  return permissions\n}\n```\n\n## Memoize Complex Transformations with useMemo in React\n\n```tsx\nimport { useMemo } from 'react'\n\nfunction ComplexDataComponent() {\n  const search = Route.useSearch()\n\n  // Memoize expensive transformations\n  const processedData = useMemo(() => {\n    return search.dashboard.widgets\n      .filter((widget) => widget.type === 'chart')\n      .map((widget) => ({\n        ...widget,\n        computedMetrics: expensiveCalculation(widget.config),\n      }))\n  }, [search.dashboard.widgets])\n\n  return (\n    <div>\n      {processedData.map((widget) => (\n        <ComplexChart key={widget.id} data={widget} />\n      ))}\n    </div>\n  )\n}\n```\n\n## Ensure correct React state updates in tests using act()\n\n```javascript\n// \u274c Bad - missing act() wrapper\nfireEvent.click(button)\nexpect(component.state).toBe(newValue)\n\n// \u2705 Good - wrapped in act()\nact(() => {\n  fireEvent.click(button)\n})\nexpect(component.state).toBe(newValue)\n```\n\n## Imperative Navigation with Optional Parameters\n\n```tsx\nfunction Component() {\n  const navigate = useNavigate()\n\n  const clearFilters = () => {\n    navigate({\n      to: '/posts/{-$category}/{-$tag}',\n      params: { category: undefined, tag: undefined },\n    })\n  }\n\n  const setCategory = (category: string) => {\n    navigate({\n      to: '/posts/{-$category}/{-$tag}',\n      params: (prev) => ({ ...prev, category }),\n    })\n  }\n\n  const applyFilters = (category?: string, tag?: string) => {\n    navigate({\n      to: '/posts/{-$category}/{-$tag}',\n      params: { category, tag },\n    })\n  }\n}\n```\n\n## Optimize Zod Validation Performance with Pre-Compilation and Selective Field Access in TanStack Router\n\n```tsx\n// Pre-compile schemas for better performance\nconst compiledSchema = zodValidator(\n  z.object({\n    query: z.string().min(1),\n    page: fallback(z.number().int().positive(), 1),\n  }),\n)\n\nexport const Route = createFileRoute('/search')({\n  validateSearch: compiledSchema,\n  component: SearchPage,\n})\n\n// Use selective validation for expensive operations\nfunction SearchPage() {\n  // Only validate specific fields when needed\n  const search = Route.useSearch({\n    select: (search) => ({\n      query: search.query,\n      page: search.page,\n    }),\n  })\n\n  return <div>Search Results</div>\n}\n```\n\n## Enable Structural Sharing at Router Level\n\n```tsx\nconst router = createRouter({\n  routeTree,\n  defaultStructuralSharing: true,\n})\n```",
    "library": "cache_router",
    "topic": "best-practices",
    "source": "fuzzy_match"
  },
  "source": "fuzzy_match",
  "saved_at": "2026-01-30T18:25:27.746171"
}