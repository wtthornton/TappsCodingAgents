{
  "library": "meta_learning",
  "topic": "usage",
  "documentation": {
    "content": "## DataSource with Lambda Functions - Basic Usage\n\n```python\n# Simple datasource with lambda functions\ndatasource = DataSource(\n    build_fn=lambda params: pd.read_csv(params.get('file', 'default.csv')),\n    transform_fn=lambda df: df.groupby('category').sum().reset_index()\n)\n```\n\n## Layout Presets Example\n\n```python\nfrom dashboard_lego.presets.layouts import kpi_row_top, two_column_8_4\n\nlayout = kpi_row_top(\n    kpi_blocks=[kpi1, kpi2, kpi3],\n    content_rows=[\n        two_column_8_4(main=chart, side=filter_panel),\n        [table_block]\n    ]\n)\n```\n\n## Base Preset Usage with KneePlotPreset\n\n```python\nfrom dashboard_lego.presets import KneePlotPreset\n\n# No controls - use values from kwargs\npreset = KneePlotPreset(\n    block_id='knee-plot',\n    datasource=datasource,\n    x_col='k',\n    y_col='inertia'\n)\n\n# All default controls\npreset = KneePlotPreset(\n    block_id='knee-plot',\n    datasource=datasource,\n    controls=True\n)\n\n# Custom control configuration\npreset = KneePlotPreset(\n    block_id='knee-plot',\n    datasource=datasource,\n    controls={\n        'x_col': True,  # Enable default control\n        'y_col': False, # Disable control\n        'auto_knee': CustomControl(...)\n    }\n)\n```\n\n## TypedChartBlock Constructor and Usage Example\n\n```python\ndef __init__(\n    self,\n    block_id: str,\n    datasource: DataSource,\n    plot_type: str,              # Name of the plot function from the registry\n    plot_params: Dict[str, Any] = None,  # Params with {{placeholders}} for controls\n    plot_kwargs: Dict[str, Any] = None,  # Static kwargs for the plot function\n    title: Optional[str] = None,         # Static card title (no placeholders)\n    plot_title: Optional[str] = None,   # Dynamic plot title (supports {{placeholders}})\n    controls: Optional[Dict[str, Control]] = None,  # Optional embedded controls\n    subscribes_to: Union[str, List[str], None] = None,\n    transform_fn: Optional[Callable[[pd.DataFrame], pd.DataFrame]] = None,  # NEW in v0.15\n    **kwargs\n)\n\nchart = TypedChartBlock(\n    block_id=\"sales_chart\",\n    datasource=datasource,\n    plot_type=\"scatter\",\n    plot_params={\"x\": \"date\", \"y\": \"sales\", \"color\": \"{{metric_selector}}\"},\n    title=\"Sales Analysis\",                    # Static card title\n    plot_title=\"Sales by {{metric_selector}}\", # Dynamic plot title with placeholder\n    subscribes_to=[\"metric_selector\"]\n)\n```\n\n## DataSource Constructor Signature\n\n```python\ndef __init__(\n    self,\n    data_builder: Optional[DataBuilder] = None,\n    data_transformer: Optional[DataTransformer] = None,\n    param_classifier: Optional[Callable[[str], str]] = None,\n    cache_dir: Optional[str] = None,\n    cache_ttl: int = 300,\n    build_fn: Optional[Callable[[Dict[str, Any]], pd.DataFrame]] = None,\n    transform_fn: Optional[Callable[[pd.DataFrame], pd.DataFrame]] = None,\n    cache_prewarm_params: Optional[List[Dict[str, Any]]] = None,\n    **kwargs\n)\n```\n\n## TypedChartBlock with Block-Level Data Transformations\n\n```python\ntop_products_chart = TypedChartBlock(\n    block_id=\"top_products\",\n    datasource=datasource,\n    plot_type='bar',\n    plot_params={'x': 'Product', 'y': 'total_revenue'},\n    title=\"Top 10 Products by Revenue\",\n    subscribes_to=['filters-category'],\n    transform_fn=lambda df: (\n        df.groupby('Product')['Revenue']\n          .sum()\n          .reset_index(name='total_revenue')\n          .sort_values('total_revenue', ascending=False)\n          .head(10)\n    )\n)\n```\n\n## Common Data Transformation Patterns (Python)\n\n```python\n# Aggregation\nlambda df: df.groupby('column').agg({'metric': 'sum'})\n```\n\n## Common Data Transformation Patterns (Python)\n\n```python\n# Filtering\nlambda df: df[df['value'] > threshold]\n```\n\n## Common Data Transformation Patterns (Python)\n\n```python\n# Pivot\nlambda df: df.pivot_table(index='x', columns='y', values='z')\n```\n\n## Common Data Transformation Patterns (Python)\n\n```python\n# Complex transforms\n# Define a function with multiple steps\n```\n\n## Python Cache Sharing in Dashboard LEGO Datasources\n\n```python\nfrom dashboard_lego.core import DataSource, DataBuilder\n\n# Dummy DataBuilder for example\nclass MyDataBuilder(DataBuilder):\n    def build(self, params):\n        print(\"Executing build...\")\n        # Simulate data loading/processing\n        return [{'id': 1, 'value': 'A'}, {'id': 2, 'value': 'B'}]\n\n# Create main datasource\nmain_ds = DataSource(\n    data_builder=MyDataBuilder(),\n    cache_dir=None  # In-memory cache\n)\n\n# Create derived datasource with additional transform\nfiltered_ds = main_ds.with_transform_fn(\n    lambda df: [item for item in df if item['value'] == 'A']\n)\n\n# Cache is shared automatically:\nprint(f\"Cache shared: {main_ds.cache is filtered_ds.cache}\")\n\n# Stage1 (builder.build) executes only ONCE:\ndata1 = main_ds.get_processed_data()      # Triggers build()\ndata2 = filtered_ds.get_processed_data()  # Reuses cached build, only applies filter\n\nprint(f\"Data from main_ds: {data1}\")\nprint(f\"Data from filtered_ds: {data2}\")\n\n# Result: No duplicate expensive data loading/processing\n```\n\n## Dynamic Control Options and Default Values in YAML\n\n```yaml\n# \u2705 Good: Dynamic control options\nenvironment:\n  - metric_options\ncards:\n  - type: control_panel\n    controls:\n      - name: metric_selector\n        type: dropdown\n        options: $metric_options      # Variable interpolation\n        value: \"{{default_metric}}\"  # Placeholder for default\n\n```\n\n## Multi-State Subscriptions in Python\n\n```python\n# Multiple publishers\ndate_filter = ControlPanelBlock(\n    block_id=\"date_filter\",\n    datasource=datasource,\n    title=\"Date Range\",\n    controls={\"date_range\": Control(...)}\n)\n\ncategory_filter = ControlPanelBlock(\n    block_id=\"category_filter\",\n    datasource=datasource,\n    title=\"Category\",\n    controls={\"category\": Control(...)}\n)\n\n# Subscriber to multiple states\nchart = TypedChartBlock(\n    block_id=\"multi_chart\",\n    datasource=datasource,\n    title=\"Filtered Analysis\",\n    plot_type='bar',\n    plot_params={'x': 'Product', 'y': 'Sales'},\n    subscribes_to=[\n        \"date_filter-date_range\",\n        \"category_filter-category\"\n    ]\n)\n```",
    "library": "learning_dashboard",
    "topic": "usage",
    "source": "fuzzy_match"
  },
  "source": "fuzzy_match",
  "saved_at": "2026-01-30T18:26:12.137577"
}