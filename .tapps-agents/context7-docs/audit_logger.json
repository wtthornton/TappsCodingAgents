{
  "library": "audit_logger",
  "topic": null,
  "documentation": {
    "content": "## Recommended Batch Processing Configuration (Rust)\n\n```rust\nuse rat_logger::{LoggerBuilder, LevelFilter, FormatConfig};\n\nfn main() {\n    let format_config = FormatConfig {\n        timestamp_format: \"%Y-%m-%d %H:%M:%S%.3f\".to_string(),\n        level_style: rat_logger::LevelStyle::default(),\n        format_template: \"{timestamp} [{level}] {message}\".to_string(),\n    };\n\n    // Synchronous mode: automatically uses sync batch config for immediate output\n    LoggerBuilder::new()\n        .with_level(LevelFilter::Info)\n        .add_terminal_with_config(rat_logger::handler::term::TermConfig {\n            enable_color: true,\n            format: Some(format_config),\n            color: None,\n        })\n        .init_global_logger()\n        .unwrap();\n}\n```\n\n## Rust: \u76f4\u63a5\u8c03\u7528LoggerCore\u5b9e\u4f8b - \u6b63\u5e38\u5de5\u4f5c\u573a\u666f\n\n```rust\nlet logger = LoggerBuilder::new()\n    .with_level(LevelFilter::Info)\n    .add_terminal_with_config(TermConfig::default())\n    .build();\n\nlet record = Record { /* ... */ };\nlogger.log(&record); // \u8f93\u51fa\u6b63\u5e38\n```\n\n## Rust: \u667a\u80fd\u5065\u5eb7\u68c0\u67e5\u673a\u5236\n\n```rust\nimpl ProcessorManager {\n    pub fn smart_health_check(&self, timeout_ms: u64) -> Result<(), String> {\n        let start = std::time::Instant::now();\n\n        while start.elapsed().as_millis() < timeout_ms as u128 {\n            if self.all_workers_ready() {\n                return Ok(());\n            }\n            std::thread::sleep(std::time::Duration::from_millis(10));\n        }\n\n        Err(format!(\"\u8d85\u65f6: {}ms\u5185\u5de5\u4f5c\u7ebf\u7a0b\u672a\u5c31\u7eea\", timeout_ms))\n    }\n}\n```\n\n## Configure Production and Development Logging Modes (Rust)\n\n```rust\nuse rat_logger::{LoggerBuilder, LevelFilter, FileConfig};\nuse std::path::PathBuf;\n\nfn main() {\n    // Production environment configuration (recommended)\n    let prod_logger = LoggerBuilder::new()\n        .with_level(LevelFilter::Info)\n        .add_terminal_with_config(rat_logger::handler::term::TermConfig::default())\n        .build();\n\n    // Development environment configuration (immediate output)\n    let dev_logger = LoggerBuilder::new()\n        .with_level(LevelFilter::Debug)\n        .with_dev_mode(true)  // Enable development mode for immediate output\n        .add_terminal_with_config(rat_logger::handler::term::TermConfig::default())\n        .build();\n\n    // Production file logger configuration\n    let file_config = FileConfig {\n        log_dir: PathBuf::from(\"./app_logs\"),\n        max_file_size: 10 * 1024 * 1024,  // 10MB\n        max_compressed_files: 5,\n        compression_level: 4,\n        min_compress_threads: 2,\n        skip_server_logs: false,\n        is_raw: false,\n        compress_on_drop: false,\n        force_sync: false,      // Asynchronous writing for better performance\n        format: None,\n    };\n\n    let prod_file_logger = LoggerBuilder::new()\n        .with_level(LevelFilter::Info)\n        .add_file(file_config)\n        .build();\n}\n```\n\n## Rust: Configure Balanced Log Persistence\n\n```rust\n.with_batch_config(BatchConfig {\n    batch_size: 512,        // 512 bytes batch size\n    batch_interval_ms: 10,  // 10ms flush interval\n    buffer_size: 1024,      // 1KB buffer\n})\n```\n\n## Rust: \u91cd\u65b0\u542f\u7528\u65e5\u5fd7\u5668\u5065\u5eb7\u68c0\u67e5\u4ee5\u89e3\u51b3\u521d\u59cb\u5316\u95ee\u9898\n\n```rust\n// \u5728init_global_logger\u65b9\u6cd5\u4e2d\u91cd\u65b0\u542f\u7528\u5065\u5eb7\u68c0\u67e5\nif let Err(e) = logger_core.wait_for_workers_ready(5000) {\n    panic!(\"\u274c \u65e5\u5fd7\u5668\u521d\u59cb\u5316\u5931\u8d25\uff1a\u5de5\u4f5c\u7ebf\u7a0b\u5065\u5eb7\u68c0\u67e5\u5931\u8d25: {}\", e);\n}\n```\n\n## Rust: Configure High Performance Log Persistence\n\n```rust\n.with_batch_config(BatchConfig {\n    batch_size: 2048,       // 2KB batch size\n    batch_interval_ms: 25,   // 25ms flush interval\n    buffer_size: 4096,      // 4KB buffer\n})\n```\n\n## Rust: \u5168\u5c40\u65e5\u5fd7\u5668\u5b8f\u8c03\u7528 - \u5f02\u5e38\u5de5\u4f5c\u573a\u666f\n\n```rust\nLoggerBuilder::new()\n    .with_level(LevelFilter::Info)\n    .add_terminal_with_config(TermConfig::default())\n    .init_global_logger()?;\n\ninfo!(\"\u8fd9\u6761\u65e5\u5fd7\u4e0d\u4f1a\u8f93\u51fa\"); // \u6ca1\u6709\u8f93\u51fa\n```\n\n## Rust: \u63a8\u8350\u7684\u5168\u5c40\u65e5\u5fd7\u5668\u521d\u59cb\u5316\u6a21\u5f0f\n\n```rust\n// \u63a8\u8350\u7684\u521d\u59cb\u5316\u6a21\u5f0f\npub fn init_global_logger(self) -> Result<(), SetLoggerError> {\n    let logger = Arc::new(self.build());\n\n    // \u751f\u4ea7\u73af\u5883\uff1a\u9632\u6b62\u91cd\u590d\u521d\u59cb\u5316\n    let _lock = LOGGER_LOCK.write().unwrap();\n    let mut guard = LOGGER.lock().unwrap();\n\n    if guard.is_some() {\n        eprintln!(\"\u26a0\ufe0f  \u8b66\u544a\uff1a\u5168\u5c40\u65e5\u5fd7\u5668\u5df2\u7ecf\u521d\u59cb\u5316\uff0c\u8df3\u8fc7\u91cd\u590d\u521d\u59cb\u5316\");\n        return Ok(());\n    }\n\n    *guard = Some(logger.clone());\n\n    // \u7b49\u5f85\u5de5\u4f5c\u7ebf\u7a0b\u5c31\u7eea\n    if let Some(logger_core) = guard.as_ref() {\n        let logger_ptr = logger.as_ref() as *const dyn Logger;\n        let logger_core_ptr = logger_ptr as *const LoggerCore;\n\n        if !logger_ptr.is_null() && !logger_core_ptr.is_null() {\n            let logger_core = unsafe { &*logger_core_ptr };\n            logger_core.wait_for_workers_ready(5000)?;\n        }\n    }\n\n    Ok(())\n}\n```\n\n## Configure Synchronous Batch Processing for Reliability (Rust)\n\n```rust\n// Synchronous mode for reliable output (CLI tools)\nuse rat_logger::{LoggerBuilder, LevelFilter, BatchConfig};\n\nfn main() -> Result<(), Box<dyn std::error::Error>> {\n    LoggerBuilder::new()\n        .with_level(LevelFilter::Info)\n        .with_batch_config(BatchConfig {\n            batch_size: 1,           // Immediate write\n            batch_interval_ms: 1,    // Minimal delay\n            buffer_size: 1024,       // Small buffer\n        })\n        .add_terminal_with_config(rat_logger::handler::term::TermConfig::default())\n        .init_global_logger()?;\n\n    Ok(())\n}\n```",
    "library": "audit_logger",
    "topic": "best-practices",
    "source": "fuzzy_match"
  },
  "source": "fuzzy_match",
  "saved_at": "2026-01-30T16:11:05.854904"
}