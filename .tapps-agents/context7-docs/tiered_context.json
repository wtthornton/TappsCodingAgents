{
  "library": "tiered_context",
  "topic": null,
  "documentation": {
    "content": "## Filter VectorStore Searches and Manage Collections\n\n```python\nfrom deepcontext import VectorStore\nfrom deepcontext.models import SourceType\n\nstore = VectorStore(collection_name=\"docs\")\n\n# Search with filters\nresults = store.search(\n    query=\"async functions\",\n    limit=10,\n    source_type=SourceType.GITHUB,\n    language=\"typescript\"\n)\n\nprint(f\"Found {len(results)} TypeScript examples from GitHub\")\n\n# Get collection statistics\nstats = store.get_stats()\nprint(f\"Collection: {stats['collection_name']}\")\nprint(f\"Total points: {stats['points_count']}\")\nprint(f\"Indexed vectors: {stats['indexed_vectors_count']}\")\nprint(f\"Status: {stats['status']}\")\n\n# Delete chunks by source\ndeleted = store.delete_by_source(\"https://example.com/old-docs\")\nprint(f\"Deleted {deleted} chunks from old source\")\n\n# Delete by document ID\ndeleted = store.delete_by_document_id(\"abc123def456\")\nprint(f\"Deleted {deleted} chunks from document\")\n\n# Clear entire collection\nstore.clear()\nprint(\"Collection cleared and recreated\")\n\nstore.close()\n```\n\n## Example Search Result Output\n\n```text\nSearch Results for: how to redirect in middleware\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n### Example\nSource: /path/to/middleware.md\nScore: 0.6693\n\nExample typescript code demonstrating implementation.\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 import { NextResponse } from 'next/server'               \u2502\n\u2502 import type { NextRequest } from 'next/server'           \u2502\n\u2502                                                          \u2502\n\u2502 export function middleware(request: NextRequest) {       \u2502\n\u2502   return NextResponse.redirect(new URL('/home', ...))\n\u2502 }\n\u2502                                                          \u2502\n\u2502 export const config = {                                  \u2502\n\u2502   matcher: '/about/:path*',                              \u2502\n\u2502 }\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n```\n\n## Index and Search Chunks with VectorStore in Qdrant\n\n```python\nfrom deepcontext import ContentFetcher, VectorStore\nfrom deepcontext.chunker import MarkdownCodeChunker\nfrom deepcontext.models import SourceType\n\n# Initialize vector store\nstore = VectorStore(\n    host=\"localhost\",\n    port=6333,\n    collection_name=\"my_docs\",\n    embedding_model=\"BAAI/bge-small-en-v1.5\"\n)\n\n# Fetch, chunk, and index content\nwith ContentFetcher() as fetcher:\n    doc = fetcher.fetch(\"https://nextjs.org/docs/app/building-your-application/routing/middleware\")\n\nchunker = MarkdownCodeChunker()\nchunks = chunker.chunk_document(doc)\n\n# Index chunks\nindexed = store.index_chunks(chunks)\nprint(f\"Indexed {indexed} chunks\")\n\n# Search for similar content\nresults = store.search(\n    query=\"how to redirect in middleware\",\n    limit=5\n)\n\nfor result in results:\n    print(f\"\\nScore: {result.score:.4f}\")\n    print(f\"Title: {result.chunk.title}\")\n    print(f\"Description: {result.chunk.description}\")\n    print(f\"Source: {result.chunk.source}\")\n\n    # Display code blocks\n    for code in result.chunk.code_blocks:\n        print(f\"\\nCode ({result.chunk.language}):\")\n        print(code[:200])\n\nstore.close()\n```\n\n## Perform Semantic Search and Display Results (Python)\n\n```python\nfrom deepcontext.vector_store import VectorStore # Assuming VectorStore is already initialized and 'store' is available\n\n# Perform searches\nqueries = [\n    \"how to configure middleware\",\n    \"button component example\",\n    \"deployment best practices\"\n]\n\nfor query in queries:\n    print(f\"\\n{'='*60}\")\n    print(f\"Query: {query}\")\n    print('='*60)\n\n    # Assuming 'store' is an initialized VectorStore instance\n    results = store.search(query, limit=3)\n\n    for i, result in enumerate(results, 1):\n        print(f\"\\n{i}. {result.chunk.title} (Score: {result.score:.4f})\")\n        print(f\"   Source: {result.chunk.source}\")\n        print(f\"   {result.chunk.description[:150]}...\")\n\n# Cleanup (assuming 'store' is the VectorStore instance)\n# store.close()\n# library_store.close() # Assuming library_store is also initialized\n```\n\n## Clear Data\n\n```APIDOC\n## DELETE /clear\n\n### Description\nClears all data from the vector store. This operation requires confirmation.\n\n### Method\nDELETE\n\n### Endpoint\n`/clear`\n\n### Parameters\n#### Query Parameters\n- **collection** (string) - Optional - Qdrant collection name. Defaults to \"deepcontext_chunks\".\n- **host** (string) - Optional - Qdrant host. Defaults to \"localhost\".\n- **port** (integer) - Optional - Qdrant port. Defaults to 6333.\n\n### Request Example\n```bash\n# Clear data from the default collection (will prompt for confirmation)\nuv run deepcontext clear\n\n# Clear data from a specific collection\nuv run deepcontext clear --collection old_data\n```\n\n### Response\n(Details on success/error responses, including the confirmation prompt, would typically be here, but are not provided in the source text.)\n```\n\n## Get Job Details\n\n```APIDOC\n## GET /job/{job_id}\n\n### Description\nShows detailed information for a specific job, including its status, counts, timestamps, and any error messages.\n\n### Method\nGET\n\n### Endpoint\n`/job/<job_id>`\n\n### Parameters\n#### Path Parameters\n- **job_id** (string) - Required - The unique identifier for the job.\n\n### Request Example\n```bash\n# Get details for a job with ID '123e4567-e89b-12d3-a456-426614174000'\nuv run deepcontext job 123e4567-e89b-12d3-a456-426614174000\n```\n\n### Response\n(Details on the structure of the job details response would typically be here, but are not provided in the source text.)\n```\n\n## Manage Vector Store with DeepContext\n\n```bash\n# Show statistics\nuv run deepcontext stats\n\n# Clear all data (requires confirmation)\nuv run deepcontext clear\n```\n\n## Initialize and Index Chunks into Vector Store (Python)\n\n```python\nfrom deepcontext.vector_store import VectorStore\nfrom deepcontext.indexing import derive_library_id, library_id_to_collection_name\nfrom deepcontext.library_store import library_store\n\n# Determine library ID and collection for indexing\nlibrary_id = derive_library_id(\"vercel/next.js\", \"repo\")\ncollection_name = library_id_to_collection_name(library_id)\n\n# Initialize vector store with per-library collection\nstore = VectorStore(\n    host=\"localhost\",\n    port=6333,\n    collection_name=collection_name\n)\n\n# Index all chunks\n# Assuming 'all_chunks' is populated from the previous step\nindexed = store.index_chunks(all_chunks, batch_size=100)\nprint(f\"Indexed {indexed} chunks into collection: {collection_name}\")\n\n# Update library metadata\nlibrary_store.update_library_metadata(\n    library_id=library_id,\n    documents_count=len(github_docs + website_docs + confluence_docs), # Assuming these are defined from previous step\n    chunks_count=indexed\n)\n```\n\n## Show Statistics\n\n```APIDOC\n## GET /stats\n\n### Description\nShows statistics about the vector store, such as the number of indexed documents and collections.\n\n### Method\nGET\n\n### Endpoint\n`/stats`\n\n### Parameters\n#### Query Parameters\n- **collection** (string) - Optional - Qdrant collection name. Defaults to \"deepcontext_chunks\".\n- **host** (string) - Optional - Qdrant host. Defaults to \"localhost\".\n- **port** (integer) - Optional - Qdrant port. Defaults to 6333.\n\n### Request Example\n```bash\n# Get stats for the default collection\nuv run deepcontext stats\n\n# Get stats for a specific collection\nuv run deepcontext stats --collection my_custom_collection\n```\n\n### Response\n(Details on the structure of the statistics response would typically be here, but are not provided in the source text.)\n```\n\n## Python: Fetch Content from Multiple Sources\n\n```python\nfrom deepcontext import ContentFetcher\n\n# Basic usage with context manager\nwith ContentFetcher() as fetcher:\n    # Local markdown file\n    doc = fetcher.fetch(\"./docs/README.md\")\n    print(f\"Title: {doc.title}\")\n    print(f\"Content length: {len(doc.content)}\")\n\n    # GitHub file\n    doc = fetcher.fetch(\"https://github.com/vercel/next.js/blob/canary/docs/api-reference/components/image.md\")\n    print(f\"Source: {doc.source_type}\")\n\n    # Webpage\n    doc = fetcher.fetch(\"https://nextjs.org/docs/app/building-your-application/routing\")\n    print(f\"Metadata: {doc.metadata}\")\n\n# With custom timeout\nfetcher = ContentFetcher(timeout=60.0)\ndoc = fetcher.fetch(\"https://example.com/slow-page\")\nfetcher.close()\n\n# Confluence with authentication\nimport os\nos.environ[\"CONFLUENCE_EMAIL\"] = \"you@company.com\"\nos.environ[\"CONFLUENCE_TOKEN\"] = \"your_token\"\n\nwith ContentFetcher() as fetcher:\n    doc = fetcher.fetch(\"https://company.atlassian.net/wiki/spaces/DOCS/pages/123456\")\n    print(f\"Confluence page: {doc.title}\")\n    print(f\"Version: {doc.metadata.get('version')}\")\n\n```\n",
    "library": "tiered_context",
    "topic": "overview",
    "source": "api"
  },
  "source": "api",
  "saved_at": "2026-01-30T18:24:58.547974"
}