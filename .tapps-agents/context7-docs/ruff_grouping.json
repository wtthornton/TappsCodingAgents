{
  "library": "ruff_grouping",
  "topic": null,
  "documentation": {
    "content": "## Type Context Propagation in Nested Comprehensions in Python\n\n```python\ntable = [[(x, y) for x in range(3)] for y in range(3)]\nreveal_type(table)  # revealed: list[list[tuple[int, int] | Unknown] | Unknown]\n\ntable_with_content: list[list[tuple[int, int, str | None]]] = [[(x, y, None) for x in range(3)] for y in range(3)]\nreveal_type(table_with_content)  # revealed: list[list[tuple[int, int, str | None]]]\n```\n\n## Python Project Structure with pyproject.toml\n\n```text\nname = \"my_proj\"\nversion = \"0.1.0\"\n\n```\n\n## Setting Attributes on Union Types\n\n```python\ndef _(flag: bool) -> None:\n    if flag:\n        class C1:\n            attr: int = 0\n\n    else:\n        class C1:\n            attr: str = \"\"\n\n    # TODO: The error message here could be improved to explain why the assignment fails.\n    C1.attr = 1  # error: [invalid-assignment]\n\n    class C2:\n        if flag:\n            attr: int = 0\n        else:\n            attr: str = \"\"\n\n    # TODO: This should be an error\n    C2.attr = 1\n```\n\n## Basic List, Set, and Dictionary Comprehensions in Python\n\n```python\n# revealed: int\n[reveal_type(x) for x in range(3)]\n\nclass Row:\n    def __next__(self) -> range:\n        return range(3)\n\nclass Table:\n    def __iter__(self) -> Row:\n        return Row()\n\n# revealed: tuple[int, range]\n[reveal_type((cell, row)) for row in Table() for cell in row]\n\n# revealed: int\n{reveal_type(x): 0 for x in range(3)}\n\n# revealed: int\n{0: reveal_type(x) for x in range(3)}\n```\n\n## Type Context Impact on Comprehension Inference in Python\n\n```python\n# Without type context:\nreveal_type([x for x in [1, 2, 3]])  # revealed: list[Unknown | int]\nreveal_type({x: \"a\" for x in [1, 2, 3]})  # revealed: dict[Unknown | int, str | Unknown]\nreveal_type({str(x): x for x in [1, 2, 3]})  # revealed: dict[str | Unknown, Unknown | int]\nreveal_type({x for x in [1, 2, 3]})  # revealed: set[Unknown | int]\n\n# With type context:\nxs: list[int] = [x for x in [1, 2, 3]]\nreveal_type(xs)  # revealed: list[int]\n\nys: dict[int, str] = {x: str(x) for x in [1, 2, 3]}\nreveal_type(ys)  # revealed: dict[int, str]\n\nzs: set[int] = {x for x in [1, 2, 3]}\n```\n\n## Set Comprehension in Python\n\n```python\nreveal_type({x for x in range(42)})  # revealed: set[int | Unknown]\n```\n\n## Editable Package Installation via .pth file\n\n```pth\naproj/src/\n\n```\n\n## Type Literal Promotion in Python Comprehensions\n\n```python\nreveal_type([x for x in (\"a\", \"b\", \"c\")])  # revealed: list[str | Unknown]\nreveal_type({x for x in (1, 2, 3)})  # revealed: set[int | Unknown]\nreveal_type({k: 0 for k in (\"a\", \"b\", \"c\")})  # revealed: dict[str | Unknown, int | Unknown]\n```\n\n## Handling Cyclic Class Definitions in Python\n\n```python\nclass A(B): ...  # error: [cyclic-class-definition]\nclass B(C): ...  # error: [cyclic-class-definition]\nclass C(A): ...  # error: [cyclic-class-definition]\n\nreveal_type(A.__class__)  # revealed: type[Unknown]\n```\n\n## Instance Attributes with Class-Level Defaults Assignment\n\n```python\nclass C:\n    attr: int = 0\n\ninstance = C()\ninstance.attr = 1  # fine\ninstance.attr = \"wrong\"  # error: [invalid-assignment]\n\nC.attr = 1  # fine\nC.attr = \"wrong\"  # error: [invalid-assignment]\n```\n\nContext7 cache for ruff_grouping: cached at 2026-02-03T17:50:07.527335+00:00Z; consider refreshing if docs changed.",
    "library": "ruff_grouping",
    "topic": "overview",
    "source": "cache"
  },
  "source": "cache",
  "saved_at": "2026-02-03T09:50:07.625927"
}