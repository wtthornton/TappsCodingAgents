{
  "library": "playwright",
  "topic": null,
  "documentation": {
    "content": "## Manage Multiple Keys with PyJWKSet in Python\n\n```python\nimport jwt\nfrom jwt.api_jwk import PyJWKSet\n\n# Example JWKSet data (typically obtained from a JWKS endpoint)\njwk_set_data = {\n    \"keys\": [\n        {\n            \"kty\": \"RSA\",\n            \"kid\": \"key1\",\n            \"n\": \"...\",\n            \"e\": \"AQAB\"\n        },\n        {\n            \"kty\": \"EC\",\n            \"kid\": \"key2\",\n            \"crv\": \"P-256\",\n            \"x\": \"...\",\n            \"y\": \"...\"\n        }\n    ]\n}\n\njwk_set = PyJWKSet.from_dict(jwk_set_data)\n\n# Find a key by kid\nkey_to_use = jwk_set.get_key(\"key1\")\n\n# Process tokens using keys from the JWKSet\n# Example: Decode a token using a key found in the JWKSet\n# token = \"...\"\n# try:\n#     header = jwt.get_unverified_header(token)\n#     kid = header['kid']\n#     signing_key = jwk_set.get_key(kid)\n#     decoded = jwt.decode(token, signing_key.key, algorithms=[\"RS256\"])\n# except Exception as e:\n#     print(f\"Decoding failed: {e}\")\n```\n\n## Manage JWK Sets with PyJWKSet - Python\n\n```python\nfrom jwt.jwk import PyJWKSet\nimport jwt\n\njwk_set_data = {\n    \"keys\": [\n        {\n            \"kty\": \"oct\",\n            \"k\": \"GawgguFyGrWKav7AX4VKUg\",\n            \"kid\": \"key-1\",\n            \"alg\": \"HS256\"\n        },\n        {\n            \"kty\": \"oct\",\n            \"k\": \"AyM1SysPpbyDfgZld3umj1qzKObwVMkoqQ\",\n            \"kid\": \"key-2\",\n            \"alg\": \"HS256\"\n        },\n        {\n            \"kty\": \"RSA\",\n            \"kid\": \"key-3\",\n            \"use\": \"sig\",\n            \"n\": \"0vx7agoebGc...\",\n            \"e\": \"AQAB\"\n        }\n    ]\n}\n\njwk_set = PyJWKSet.from_dict(jwk_set_data)\n\nkey_1 = jwk_set[\"key-1\"]\nprint(f\"Found key: {key_1.key_id}\")\n\nfor key in jwk_set:\n    print(f\"Key ID: {key.key_id}, Algorithm: {key.algorithm_name}\")\n\ntoken = jwt.encode({\"data\": \"value\"}, key_1.key, algorithm=key_1.algorithm_name)\ndecoded = jwt.decode(token, key_1.key, algorithms=[key_1.algorithm_name])\n\njwk_set_json = '{\"keys\":[{\"kty\":\"oct\",\"k\":\"secret\",\"kid\":\"k1\"}]}'\nkeyset = PyJWKSet.from_json(jwk_set_json)\n```\n\n## Prefer direct indexing over options.get() in pyjwt\n\n```python\n# Prefer direct indexing over options.get() (#552) by @jdufresne\n```\n\n## Use direct indexing in PyJWKClient.get_signing_key_from_jwt()\n\n```python\n# Use direct indexing in PyJWKClient.get_signing_key_from_jwt() (#558) by @jdufresne\n```\n\n## Fetch JWKS Endpoints with PyJWKClient - Python\n\n```python\nimport jwt\nfrom jwt.jwks_client import PyJWKClient\n\njwks_url = \"https://auth.example.com/.well-known/jwks.json\"\n\njwks_client = PyJWKClient(\n    uri=jwks_url,\n    cache_keys=True,\n    max_cached_keys=16,\n    cache_jwk_set=True,\n    lifespan=300,\n    headers={\"User-Agent\": \"MyApp/1.0\"},\n    timeout=30\n)\n\ntoken = \"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6ImtleS0xMjMifQ...\"\n\nsigning_key = jwks_client.get_signing_key_from_jwt(token)\n\nprint(f\"Using key: {signing_key.key_id}\")\nprint(f\"Algorithm: {signing_key.algorithm_name}\")\n\ndecoded = jwt.decode(\n    token,\n    signing_key.key,\n    algorithms=[signing_key.algorithm_name],\n    audience=\"https://api.example.com\",\n    issuer=\"https://auth.example.com\"\n)\nprint(decoded)\n\nspecific_key = jwks_client.get_signing_key(\"key-123\")\n\nfresh_key = jwks_client.get_signing_key_from_jwt(token)\n```\n\n## JWT Subject (sub) Claim Handling with PyJWT\n\n```pycon\n>>> payload = {\"some\": \"payload\", \"sub\": \"1234567890\"}\n>>> token = jwt.encode(payload, \"secret\")\n>>> decoded = jwt.decode(token, \"secret\", algorithms=[\"HS256\"])\n>>> decoded[\"sub\"]\n'1234567890'\n```\n\n## Fix tox 'docs' environment to pass in pyjwt\n\n```python\n# Fix tox \"docs\" environment to pass (#567) by @jdufresne\n```\n\n## JWT Audience (aud) Validation in Python\n\n```python\nimport jwt\nfrom jwt.exceptions import InvalidAudienceError\n\nsecret = \"secret-key\"\n\n# Single audience\npayload_single = {\"user\": \"dave\", \"aud\": \"https://api.example.com\"}\ntoken_single = jwt.encode(payload_single, secret, algorithm=\"HS256\")\n\n# Decode with correct audience\ndecoded = jwt.decode(\n    token_single,\n    secret,\n    algorithms=[\"HS256\"],\n    audience=\"https://api.example.com\"\n)\n\n# Multiple audiences in token\npayload_multi = {\n    \"user\": \"eve\",\n    \"aud\": [\"https://api.example.com\", \"https://admin.example.com\"]\n}\ntoken_multi = jwt.encode(payload_multi, secret, algorithm=\"HS256\")\n\n# Validate against one of multiple audiences\ndecoded = jwt.decode(\n    token_multi,\n    secret,\n    algorithms=[\"HS256\"],\n    audience=\"https://api.example.com\"\n)\n\n# Accept multiple possible audiences\ndecoded = jwt.decode(\n    token_multi,\n    secret,\n    algorithms=[\"HS256\"],\n    audience=[\"https://api.example.com\", \"https://other.example.com\"]\n)\n\n# This raises InvalidAudienceError\ntry:\n    jwt.decode(\n        token_single,\n        secret,\n        algorithms=[\"HS256\"],\n        audience=\"https://wrong.example.com\"\n    )\nexcept InvalidAudienceError:\n    print(\"Invalid audience!\")\n```\n\n## PyJWT: Decode Complete JWT Components\n\n```python\nimport jwt\n\ntoken = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImtleS0xIn0.eyJ1c2VyIjoiam9obiJ9.signature\"\nsecret_key = \"your-secret\"\n\n# Get all components\ndecoded_complete = jwt.decode_complete(token, secret_key, algorithms=[\"HS256\"])\n\nprint(decoded_complete[\"header\"])\n\nprint(decoded_complete[\"payload\"])\n\nprint(decoded_complete[\"signature\"])\n\n# Read header without verification\nheader_only = jwt.get_unverified_header(token)\nprint(header_only)\n```\n\n## Install PyJWT with Cryptographic Dependencies\n\n```console\n$ pip install pyjwt[crypto]\n```",
    "library": "pyjwt",
    "topic": "overview",
    "source": "fuzzy_match"
  },
  "source": "fuzzy_match",
  "saved_at": "2026-01-30T18:30:09.949885"
}