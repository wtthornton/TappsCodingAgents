{
  "library": "score_constants",
  "topic": "best-practices",
  "documentation": {
    "content": "## Policy-Based View Authorization (Good Practice) Slim\n\n```Slim\n- if policy(:accountant).show?\n  = render 'accountant'\n```\n\n## Implementing Data Migration with ActiveRecord in Rails\n\n```Ruby\nclass MoveTags < ActiveRecord::Migration[5.2]\n  # Inherit from ActiveRecord::Base instead of ApplicationRecord since the\n  # ApplicationRecord is subject to changes as the app changes.\n  class Tag < ActiveRecord::Base; end # rubocop:disable Rails/ApplicationRecord\n\n  class BlogPost < ActiveRecord::Base # rubocop:disable Rails/ApplicationRecord\n    has_many :tags\n  end\n\n  def up\n    add_column :blog_posts, :categories, :string, array: true\n\n    say(\"Moving #{Tag.count} tags to #{BlogPost.count} blog posts\")\n\n    # Use find_each to minimize memory usage when dealing with many records\n    BlogPost.find_each(batch_size: 100) do |blog_post|\n      tags = blog_post.tags.pluck(:value)\n\n      # You can never have too much logging when migrating data!\n      say(\"Moving tags #{tags} to BlogPost #{blog_post.id}\")\n\n      blog_post.update!(categories: tags)\n    end\n  end\n\n  def down\n    remove_column :blog_posts, :categories\n  end\nend\n```\n\n## View Authorization (Bad Practice) Slim\n\n```Slim\n- if current_user.admin?\n  = render 'accountant'\n```\n\n## Policy-Based Parameter Filtering (Good Practice) Ruby\n\n```Ruby\nclass UserPolicy < ApplicationPolicy\n  def permitted_attributes\n    if user.admin?\n      %i[name email role]\n    else\n      [:name]\n    end\n  end\nend\n\nclass UsersController < ApplicationController\n  def update\n    @user = User.find(params[:id])\n    if @user.update(permitted_attributes(@user))\n      redirect_to @user\n    else\n      render :edit\n    end\n  end\nend\n```\n\n## Controller Parameter Filtering (Bad Practice) Ruby\n\n```Ruby\nclass UsersController < ApplicationController\n  def update\n    @user = User.find(params[:id])\n    if @user.update(user_params)\n      redirect_to @user\n    else\n      render :edit\n    end\n  end\n\n  def user_params\n    if user.admin?\n      params.require(:user).permit(:name, :email, :role)\n    else\n      params.require(:user).permit(:name)\n    end\n  end\nend\n```\n\n## Configuring Good Job Queues in Rails Application Config - Ruby\n\n```Ruby\nRails.application.configure do\n  config.good_job.queues = \"large_task:#{max_large_tasks};-large_task\"\nend\n```\n\n## Implementing ActiveJob Error Reporting Callback - Ruby\n\n```Ruby\nActiveJob::Base.set_callback(:perform, :around) do |param, block|\n  begin\n    block.call\n  rescue StandardError => e\n    # notify error service\n    # re-raise the error\n    raise e\n  end\nend\n```\n\n## Defining Good Job with Concurrency Control - Ruby\n\n```Ruby\nclass PageIndexJob < ApplicationJob\n  include GoodJob::ActiveJobExtensions::Concurrency\n\n  good_job_control_concurrency_with(\n    total_limit: 1,\n    key: -> { \"page_index-#{arguments.first.id}\" }\n  )\n\n  def perform(page)\n    page.index\n  end\nend\n```\n\n## Controller Authorization (Bad Practice) Ruby\n\n```Ruby\nclass PostsController < ApplicationController\n  def destroy\n    post = Post.find(params[:id])\n    if post.user_id == current_user.id\n      post.destroy\t\n      redirect_to posts_path\n    else\n      redirect_to posts_path, alert: 'Forbidden'\n    end\n  end\nend\n```\n\n## Tagging Release on Master (Git Shell)\n\n```Shell\ngit checkout master\ngit tag 2016-05-16 # <date> YYYY-MM-DD\ngit push --tags\n```",
    "library": "best_practice_consultant",
    "topic": "best-practices",
    "source": "fuzzy_match"
  },
  "source": "fuzzy_match",
  "saved_at": "2026-02-03T09:49:32.957581"
}